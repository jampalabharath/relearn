<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.148.2">
    <meta name="generator" content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862">
    <meta name="description" content="175. Combine Two Tables Description Table: Person
Column Name Type PersonId int FirstName varchar LastName varchar PersonId is the primary key column for this table. Table: Address
Column Name Type AddressId int PersonId int City varchar State varchar AddressId is the primary key column for this table. Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for them:">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="SQL LeetCode :: Data Engineering Notes">
    <meta name="twitter:description" content="175. Combine Two Tables Description Table: Person
Column Name Type PersonId int FirstName varchar LastName varchar PersonId is the primary key column for this table. Table: Address
Column Name Type AddressId int PersonId int City varchar State varchar AddressId is the primary key column for this table. Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for them:">
    <meta property="og:url" content="http://localhost:1313/practice/leetcode-sql/">
    <meta property="og:site_name" content="Data Engineering Notes">
    <meta property="og:title" content="SQL LeetCode :: Data Engineering Notes">
    <meta property="og:description" content="175. Combine Two Tables Description Table: Person
Column Name Type PersonId int FirstName varchar LastName varchar PersonId is the primary key column for this table. Table: Address
Column Name Type AddressId int PersonId int City varchar State varchar AddressId is the primary key column for this table. Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for them:">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Practice Sets">
    <meta itemprop="name" content="SQL LeetCode :: Data Engineering Notes">
    <meta itemprop="description" content="175. Combine Two Tables Description Table: Person
Column Name Type PersonId int FirstName varchar LastName varchar PersonId is the primary key column for this table. Table: Address
Column Name Type AddressId int PersonId int City varchar State varchar AddressId is the primary key column for this table. Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for them:">
    <meta itemprop="wordCount" content="10301">
    <title>SQL LeetCode :: Data Engineering Notes</title>
    <link href="/practice/leetcode-sql/index.md" rel="alternate" type="text/markdown" title="SQL LeetCode :: Data Engineering Notes">
    <link href="/practice/leetcode-sql/index.print.html" rel="alternate" type="text/html" title="SQL LeetCode :: Data Engineering Notes">
    <link href="/images/favicon.ico?1761501432" rel="icon" type="image/x-icon" sizes="any">
    <link href="/css/auto-complete/auto-complete.min.css?1761501432" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1761501432" defer></script>
    <script src="/js/search-lunr.js?1761501432" defer></script>
    <script src="/js/search.js?1761501432" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1761501432";
    </script>
    <script src="/js/lunr/lunr.min.js?1761501432" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1761501432" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1761501432" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1761501432" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1761501432" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1761501432" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1761501432" rel="stylesheet">
    <link href="/css/theme.css?1761501432" rel="stylesheet">
    <link href="/css/format-html.css?1761501432" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/practice\/leetcode-sql\/';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'auto', 'zen-light', 'zen-dark' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script><style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 1000rem;
}
</style>
  </head>
  <body class="mobile-support html" data-url="/practice/leetcode-sql/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#175-combine-two-tables">175. Combine Two Tables</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#176-second-highest-salary">176. Second Highest Salary</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#177-nth-highest-salary">177. Nth Highest Salary</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#178-rank-scores">178. Rank Scores</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#180-consecutive-numbers">180. Consecutive Numbers</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#181-employees-earning-more-than-their-managers">181. Employees Earning More Than Their Managers</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#182-duplicate-emails">182. Duplicate Emails</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#183-customers-who-never-order">183. Customers Who Never Order</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#196-delete-duplicate-emails">196. Delete Duplicate Emails</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#197-rising-temperature">197. Rising Temperature</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#511-game-play-analysis-i">511. Game Play Analysis I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#512-game-play-analysis-ii">512. Game Play Analysis II</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#534-game-play-analysis-iii">534. Game Play Analysis III</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#570-managers-with-at-least-5-direct-reports">570. Managers with at Least 5 Direct Reports</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#577-employee-bonus">577. Employee Bonus</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#584-find-customer-referee">584. Find Customer Referee</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#586-customer-placing-the-largest-number-of-orders">586. Customer Placing the Largest Number of Orders</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#595-big-countries">595. Big Countries</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#596-classes-more-than-5-students">596. Classes More Than 5 Students</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#597-friend-requests-i-overall-acceptance-rate">597. Friend Requests I: Overall Acceptance Rate</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#603-consecutive-available-seats">603. Consecutive Available Seats</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#607-sales-person">607. Sales Person</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#608-tree-node">608. Tree Node</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#610-triangle-judgement">610. Triangle Judgement</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#612-shortest-distance-in-a-plane">612. Shortest Distance in a Plane</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#613-shortest-distance-in-a-line">613. Shortest Distance in a Line</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#619-biggest-single-number">619. Biggest Single Number</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#620-not-boring-movies">620. Not Boring Movies</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#626-exchange-seats">626. Exchange Seats</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#627-swap-salary">627. Swap Salary</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1045-customers-who-bought-all-products">1045. Customers Who Bought All Products</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1050-actors-and-directors-who-cooperated-at-least-three-times">1050. Actors and Directors Who Cooperated At Least Three Times</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1068-product-sales-analysis-i">1068. Product Sales Analysis I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1069-product-sales-analysis-ii">1069. Product Sales Analysis II</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1070-product-sales-analysis-iii">1070. Product Sales Analysis III</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1075-project-employees-i">1075. Project Employees I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1076-project-employees-ii">1076. Project Employees II</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1077-project-employees-iii">1077. Project Employees III</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1082-sales-analysis-i">1082. Sales Analysis I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1083-sales-analysis-ii">1083. Sales Analysis II</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1084-sales-analysis-iii">1084. Sales Analysis III</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1112-highest-grade-for-each-student">1112. Highest Grade For Each Student</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1113-reported-posts">1113. Reported Posts</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1126-active-businesses">1126. Active Businesses</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1141-user-activity-for-the-past-30-days-i">1141. User Activity for the Past 30 Days I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1142-user-activity-for-the-past-30-days-ii">1142. User Activity for the Past 30 Days II</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1148-article-views-i">1148. Article Views I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1164-product-price-at-a-given-date">1164. Product Price at a Given Date</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1173-immediate-food-delivery-i">1173. Immediate Food Delivery I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1174-immediate-food-delivery-ii">1174. Immediate Food Delivery II</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1179-reformat-department-table">1179. Reformat Department Table</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1193-monthly-transactions-i">1193. Monthly Transactions I</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1204-last-person-to-fit-in-the-elevator">1204. Last Person to Fit in the Elevator</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1211-queries-quality-and-percentage">1211. Queries Quality and Percentage</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1212-team-scores-in-football-tournament">1212. Team Scores in Football Tournament</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1225-report-contiguous-dates">1225. Report Contiguous Dates</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1241-number-of-comments-per-post">1241. Number of Comments per Post</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1251-average-selling-price">1251. Average Selling Price</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1264-page-recommendations">1264. Page Recommendations</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1270-all-people-report-to-the-given-manager">1270. All People Report to the Given Manager</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1280-students-and-examinations">1280. Students and Examinations</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1285-find-the-start-and-end-number-of-continuous-ranges">1285. Find the Start and End Number of Continuous Ranges</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1294-weather-type-in-each-country">1294. Weather Type in Each Country</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1303-find-the-team-size">1303. Find the Team Size</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1308-running-total-for-different-genders">1308. Running Total for Different Genders</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1321-restaurant-growth">1321. Restaurant Growth</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1322-ads-performance">1322. Ads Performance</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1327-list-the-products-ordered-in-a-period">1327. List the Products Ordered in a Period</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1336-number-of-transactions-per-visit">1336. Number of Transactions per Visit</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class="a11y-only"><a itemprop="item" href="/"><span itemprop="name">Data Engineering Notes</span></a><meta itemprop="position" content="1">&nbsp;/&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/practice/"><span itemprop="name">Practice Sets</span></a><meta itemprop="position" content="2">&nbsp;/&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">SQL LeetCode</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-edit" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="https://github.com/jampalabharath/relearn/tree/main/content/Practice/Leetcode-SQL.md" rel="external" target="_blank" title="Edit (CTRL+ALT+w)"><i class="fa-fw fas fa-pen"></i></a>
            </div>
            <div class="topbar-button topbar-button-markdown" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/practice/leetcode-sql/index.md" title="Show Markdown"><i class="fa-fw fab fa-markdown"></i></a>
            </div>
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/practice/leetcode-sql/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/practice/" title="Practice Sets (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/practice/pyspark1/" title="Pyspark 1 (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable practice" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="sql-leetcode">SQL LeetCode</h1>

<h2 id="175-combine-two-tables">175. Combine Two Tables</h2>
<h4 id="description">Description</h4>
<p><strong>Table: Person</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>PersonId</td>
          <td>int</td>
      </tr>
      <tr>
          <td>FirstName</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>LastName</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>PersonId</strong> is the primary key column for this table.</li>
</ul>
<p><strong>Table: Address</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>AddressId</td>
          <td>int</td>
      </tr>
      <tr>
          <td>PersonId</td>
          <td>int</td>
      </tr>
      <tr>
          <td>City</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>State</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>AddressId</strong> is the primary key column for this table.</li>
</ul>
<p>Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for them:</p>
<ul>
<li><strong>FirstName</strong></li>
<li><strong>LastName</strong></li>
<li><strong>City</strong></li>
<li><strong>State</strong></li>
</ul>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">FirstName</span><span class="p">,</span><span class="w"> </span><span class="n">LastName</span><span class="p">,</span><span class="w"> </span><span class="n">City</span><span class="p">,</span><span class="w"> </span><span class="k">State</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">PersonId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">PersonId</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="176-second-highest-salary">176. Second Highest Salary</h2>
<h4 id="description-1">Description</h4>
<p>Write a SQL query to get the second highest salary from the <strong>Employee</strong> table.</p>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Salary</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>For example, given the above Employee table:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Salary</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>100</td>
      </tr>
      <tr>
          <td>2</td>
          <td>200</td>
      </tr>
      <tr>
          <td>3</td>
          <td>300</td>
      </tr>
  </tbody>
</table>
<p>The query should return <strong>200</strong> as the second highest salary.<br>
If there is no second highest salary, then the query should return <strong>null</strong>.</p>
<p><strong>Result Table:</strong></p>
<table>
  <thead>
      <tr>
          <th>SecondHighestSalary</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>200</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">IFNULL</span><span class="p">((</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">Salary</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">OFFSET</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">),</span><span class="w"> </span><span class="k">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SecondHighestSalary</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="177-nth-highest-salary">177. Nth Highest Salary</h2>
<h4 id="description-2">Description</h4>
<p>Write a SQL query to get the <strong>nth highest salary</strong> from the <strong>Employee</strong> table.</p>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Salary</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>For example, given the above Employee table:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Salary</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>100</td>
      </tr>
      <tr>
          <td>2</td>
          <td>200</td>
      </tr>
      <tr>
          <td>3</td>
          <td>300</td>
      </tr>
  </tbody>
</table>
<p>The nth highest salary where n = 2 is <strong>200</strong>.<br>
If there is no nth highest salary, then the query should return <strong>null</strong>.</p>
<p><strong>Result Table:</strong></p>
<table>
  <thead>
      <tr>
          <th>getNthHighestSalary(2)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>200</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">getNthHighestSalary</span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="nb">INT</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">Salary</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">OFFSET</span><span class="w"> </span><span class="n">M</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="178-rank-scores">178. Rank Scores</h2>
<h4 id="description-3">Description</h4>
<p>Write a SQL query to rank scores. If there is a tie between two scores, both should have the <strong>same ranking</strong>.<br>
After a tie, the next ranking number should be the next consecutive integer value (no &ldquo;holes&rdquo; between ranks).</p>
<p><strong>Table: Scores</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Score</td>
          <td>float</td>
      </tr>
  </tbody>
</table>
<p>For example, given the above Scores table:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Score</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>3.50</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3.65</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4.00</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3.85</td>
      </tr>
      <tr>
          <td>5</td>
          <td>4.00</td>
      </tr>
      <tr>
          <td>6</td>
          <td>3.65</td>
      </tr>
  </tbody>
</table>
<p>The query should generate the following report (ordered by highest score):</p>
<table>
  <thead>
      <tr>
          <th>Score</th>
          <th>Rank</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>4.00</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4.00</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3.85</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3.65</td>
          <td>3</td>
      </tr>
      <tr>
          <td>3.65</td>
          <td>3</td>
      </tr>
      <tr>
          <td>3.50</td>
          <td>4</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MS SQL Server)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">Score</span><span class="p">,</span><span class="w"> </span><span class="n">DENSE_RANK</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="p">(</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="k">DESC</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Rank</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Scores</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL using Variables)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Score</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">rank</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">rank</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">prev</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">prev</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">Score</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Rank</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Scores</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">rank</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">prev</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL using COUNT)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Score</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">Score</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Score</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Rank</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="180-consecutive-numbers">180. Consecutive Numbers</h2>
<h4 id="description-4">Description</h4>
<p>Write a SQL query to find all numbers that appear <strong>at least three times consecutively</strong>.</p>
<p><strong>Table: Logs</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Num</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>For example, given the above Logs table:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Num</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>2</td>
      </tr>
      <tr>
          <td>5</td>
          <td>1</td>
      </tr>
      <tr>
          <td>6</td>
          <td>2</td>
      </tr>
      <tr>
          <td>7</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p>The number <code>1</code> is the only number that appears consecutively at least three times.</p>
<p><strong>Result Table:</strong></p>
<table>
  <thead>
      <tr>
          <th>ConsecutiveNums</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL, user-defined variables)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ConsecutiveNums</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Num</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">cnt</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="o">@</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">prev</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">Num</span><span class="p">),</span><span class="w"> </span><span class="o">@</span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">freq</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Logs</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">cnt</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">prev</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Logs</span><span class="w"> </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">n</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">freq</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="181-employees-earning-more-than-their-managers">181. Employees Earning More Than Their Managers</h2>
<h4 id="description-5">Description</h4>
<p>The <strong>Employee</strong> table holds all employees including their managers.<br>
Every employee has an <code>Id</code>, and there is also a column for the <code>ManagerId</code>.</p>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>Salary</td>
          <td>int</td>
      </tr>
      <tr>
          <td>ManagerId</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Name</th>
          <th>Salary</th>
          <th>ManagerId</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Joe</td>
          <td>70000</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Henry</td>
          <td>80000</td>
          <td>4</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Sam</td>
          <td>60000</td>
          <td>NULL</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Max</td>
          <td>90000</td>
          <td>NULL</td>
      </tr>
  </tbody>
</table>
<p>Write a SQL query to find employees who earn <strong>more than their managers</strong>.<br>
For the above table, Joe is the only employee who earns more than his manager.</p>
<p><strong>Result Table:</strong></p>
<table>
  <thead>
      <tr>
          <th>Employee</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Joe</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">ManagerId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">Salary</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">Salary</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="182-duplicate-emails">182. Duplicate Emails</h2>
<h4 id="description-6">Description</h4>
<p>Write a SQL query to find all <strong>duplicate emails</strong> in a table named <strong>Person</strong>.</p>
<p><strong>Table: Person</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Email</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Email</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td><a href="mailto:a@b.com" rel="external" target="_blank">a@b.com</a></td>
      </tr>
      <tr>
          <td>2</td>
          <td><a href="mailto:c@d.com" rel="external" target="_blank">c@d.com</a></td>
      </tr>
      <tr>
          <td>3</td>
          <td><a href="mailto:a@b.com" rel="external" target="_blank">a@b.com</a></td>
      </tr>
  </tbody>
</table>
<p>The query should return:</p>
<table>
  <thead>
      <tr>
          <th>Email</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="mailto:a@b.com" rel="external" target="_blank">a@b.com</a></td>
      </tr>
  </tbody>
</table>
<p><strong>Note:</strong> All emails are in lowercase.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Person</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">Email</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="183-customers-who-never-order">183. Customers Who Never Order</h2>
<h4 id="description-7">Description</h4>
<p>Suppose that a website contains two tables: <strong>Customers</strong> and <strong>Orders</strong>.<br>
Write a SQL query to find all customers who <strong>never order anything</strong>.</p>
<p><strong>Table: Customers</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Name</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Joe</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Henry</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Sam</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Max</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Orders</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>CustomerId</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>CustomerId</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>Using the above tables, the query should return:</p>
<table>
  <thead>
      <tr>
          <th>Customers</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Henry</td>
      </tr>
      <tr>
          <td>Max</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Customers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Customers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">CustomerId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Orders</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="196-delete-duplicate-emails">196. Delete Duplicate Emails</h2>
<h4 id="description-8">Description</h4>
<p>Write a SQL query to <strong>delete all duplicate email entries</strong> in a table named <strong>Person</strong>,<br>
keeping only unique emails based on the <strong>smallest Id</strong>.</p>
<p><strong>Table: Person</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>Email</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Email</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td><a href="mailto:john@example.com" rel="external" target="_blank">john@example.com</a></td>
      </tr>
      <tr>
          <td>2</td>
          <td><a href="mailto:bob@example.com" rel="external" target="_blank">bob@example.com</a></td>
      </tr>
      <tr>
          <td>3</td>
          <td><a href="mailto:john@example.com" rel="external" target="_blank">john@example.com</a></td>
      </tr>
  </tbody>
</table>
<p>After running the query, the table should look like:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Email</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td><a href="mailto:john@example.com" rel="external" target="_blank">john@example.com</a></td>
      </tr>
      <tr>
          <td>2</td>
          <td><a href="mailto:bob@example.com" rel="external" target="_blank">bob@example.com</a></td>
      </tr>
  </tbody>
</table>
<p><strong>Note:</strong> Your output is the whole Person table after executing your SQL. Use <code>DELETE</code> statement.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL, using subquery)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">Id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">minId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Person</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">q</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">minId</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL, self join)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="n">p1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">p1</span><span class="p">.</span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">p1</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">Id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="197-rising-temperature">197. Rising Temperature</h2>
<h4 id="description-9">Description</h4>
<p>Given a <strong>Weather</strong> table, write a SQL query to find all dates&rsquo; <strong>Ids</strong> with higher temperature compared to the previous (yesterday&rsquo;s) date.</p>
<p><strong>Table: Weather</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>RecordDate</td>
          <td>date</td>
      </tr>
      <tr>
          <td>Temperature</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>RecordDate</th>
          <th>Temperature</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2015-01-01</td>
          <td>10</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2015-01-02</td>
          <td>25</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2015-01-03</td>
          <td>20</td>
      </tr>
      <tr>
          <td>4</td>
          <td>2015-01-04</td>
          <td>30</td>
      </tr>
  </tbody>
</table>
<p>The query should return the following Ids:</p>
<table>
  <thead>
      <tr>
          <th>Id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2</td>
      </tr>
      <tr>
          <td>4</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">w1</span><span class="p">.</span><span class="n">Id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Weather</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">w1</span><span class="p">,</span><span class="w"> </span><span class="n">Weather</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">w2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">DATEDIFF</span><span class="p">(</span><span class="n">w1</span><span class="p">.</span><span class="n">RecordDate</span><span class="p">,</span><span class="w"> </span><span class="n">w2</span><span class="p">.</span><span class="n">RecordDate</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">w1</span><span class="p">.</span><span class="n">Temperature</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">w2</span><span class="p">.</span><span class="n">Temperature</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="511-game-play-analysis-i">511. Game Play Analysis I</h2>
<h4 id="description-10">Description</h4>
<p><strong>Table: Activity</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>player_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>device_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>event_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>games_played</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(player_id, event_date)</code> is the primary key of this table.</li>
<li>This table shows the activity of players of a game.</li>
<li>Each row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.</li>
</ul>
<p>Write an SQL query that reports the <strong>first login date</strong> for each player.</p>
<p><strong>Example: Activity table</strong></p>
<table>
  <thead>
      <tr>
          <th>player_id</th>
          <th>device_id</th>
          <th>event_date</th>
          <th>games_played</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-03-01</td>
          <td>5</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-05-02</td>
          <td>6</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
          <td>2017-06-25</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
          <td>2016-03-02</td>
          <td>0</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2018-07-03</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>player_id</th>
          <th>first_login</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2016-03-01</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2017-06-25</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2016-03-02</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">player_id</span><span class="p">,</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">event_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">first_login</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Activity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">player_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">player_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="512-game-play-analysis-ii">512. Game Play Analysis II</h2>
<h4 id="description-11">Description</h4>
<p><strong>Table: Activity</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>player_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>device_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>event_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>games_played</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(player_id, event_date)</code> is the primary key of this table.</li>
<li>This table shows the activity of players of a game.</li>
<li>Each row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.</li>
</ul>
<p>Write an SQL query that reports the <strong>device that is first logged in</strong> for each player.</p>
<p><strong>Example: Activity table</strong></p>
<table>
  <thead>
      <tr>
          <th>player_id</th>
          <th>device_id</th>
          <th>event_date</th>
          <th>games_played</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-03-01</td>
          <td>5</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-05-02</td>
          <td>6</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
          <td>2017-06-25</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
          <td>2016-03-02</td>
          <td>0</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2018-07-03</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>player_id</th>
          <th>device_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">player_id</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Activity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">player_id</span><span class="p">,</span><span class="w"> </span><span class="n">event_date</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">player_id</span><span class="p">,</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">event_date</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Activity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">player_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="534-game-play-analysis-iii">534. Game Play Analysis III</h2>
<h4 id="description-12">Description</h4>
<p><strong>Table: Activity</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>player_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>device_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>event_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>games_played</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(player_id, event_date)</code> is the primary key of this table.</li>
<li>This table shows the activity of players of a game.</li>
<li>Each row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.</li>
</ul>
<p>Write an SQL query that reports for each player and date, <strong>how many games played so far by the player</strong>.<br>
That is, the total number of games played by the player <strong>until that date</strong>. Only consider the days the player logged in.</p>
<p><strong>Example: Activity table</strong></p>
<table>
  <thead>
      <tr>
          <th>player_id</th>
          <th>device_id</th>
          <th>event_date</th>
          <th>games_played</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-03-01</td>
          <td>5</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-05-02</td>
          <td>6</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
          <td>2017-06-25</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
          <td>2016-03-02</td>
          <td>0</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2018-07-03</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>player_id</th>
          <th>event_date</th>
          <th>games_played_so_far</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2016-03-01</td>
          <td>5</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2016-05-02</td>
          <td>11</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2017-06-25</td>
          <td>12</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2016-03-02</td>
          <td>0</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2018-07-03</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong></p>
<ul>
<li>For player 1: 5 + 6 = 11 games by 2016-05-02, 5 + 6 + 1 = 12 games by 2017-06-25.</li>
<li>For player 3: 0 + 5 = 5 games by 2018-07-03.</li>
</ul>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL, using user-defined variables)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">player_id</span><span class="p">,</span><span class="w"> </span><span class="n">event_date</span><span class="p">,</span><span class="w"> </span><span class="n">games_played_so_far</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">player_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">event_date</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">games</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">player_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">player</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">games</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">games_played</span><span class="p">,</span><span class="w"> </span><span class="n">games_played</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">games_played_so_far</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">player</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">player_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Activity</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">player_id</span><span class="p">,</span><span class="w"> </span><span class="n">event_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">player</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">games</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tmp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="570-managers-with-at-least-5-direct-reports">570. Managers with at Least 5 Direct Reports</h2>
<h4 id="description-13">Description</h4>
<p>The <strong>Employee</strong> table holds all employees including their managers.<br>
Every employee has an <code>Id</code>, and there is also a column for the <code>ManagerId</code>.</p>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>Id</th>
          <th>Name</th>
          <th>Department</th>
          <th>ManagerId</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>101</td>
          <td>John</td>
          <td>A</td>
          <td>null</td>
      </tr>
      <tr>
          <td>102</td>
          <td>Dan</td>
          <td>A</td>
          <td>101</td>
      </tr>
      <tr>
          <td>103</td>
          <td>James</td>
          <td>A</td>
          <td>101</td>
      </tr>
      <tr>
          <td>104</td>
          <td>Amy</td>
          <td>A</td>
          <td>101</td>
      </tr>
      <tr>
          <td>105</td>
          <td>Anne</td>
          <td>A</td>
          <td>101</td>
      </tr>
      <tr>
          <td>106</td>
          <td>Ron</td>
          <td>B</td>
          <td>101</td>
      </tr>
  </tbody>
</table>
<p>Write a SQL query to find <strong>managers with at least 5 direct reports</strong>.<br>
No one would report to himself.</p>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>Name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>John</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">Name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">ManagerId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ManagerId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="577-employee-bonus">577. Employee Bonus</h2>
<h4 id="description-14">Description</h4>
<p>Select all employees&rsquo; <strong>name</strong> and <strong>bonus</strong> whose bonus is <strong>less than 1000</strong>.</p>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>empId</td>
          <td>int</td>
      </tr>
      <tr>
          <td>name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>supervisor</td>
          <td>int</td>
      </tr>
      <tr>
          <td>salary</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>empId</th>
          <th>name</th>
          <th>supervisor</th>
          <th>salary</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>John</td>
          <td>3</td>
          <td>1000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Dan</td>
          <td>3</td>
          <td>2000</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Brad</td>
          <td>null</td>
          <td>4000</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Thomas</td>
          <td>3</td>
          <td>4000</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Bonus</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>empId</td>
          <td>int</td>
      </tr>
      <tr>
          <td>bonus</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>empId</th>
          <th>bonus</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2</td>
          <td>500</td>
      </tr>
      <tr>
          <td>4</td>
          <td>2000</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>name</th>
          <th>bonus</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>John</td>
          <td>null</td>
      </tr>
      <tr>
          <td>Dan</td>
          <td>500</td>
      </tr>
      <tr>
          <td>Brad</td>
          <td>null</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bonus</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Bonus</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">empId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">empId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">bonus</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">bonus</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="584-find-customer-referee">584. Find Customer Referee</h2>
<h4 id="description-15">Description</h4>
<p>Given a table <strong>customer</strong> holding customer information and the referee.</p>
<p><strong>Table: customer</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>referee_id</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>Example data:</p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>name</th>
          <th>referee_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Will</td>
          <td>NULL</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Jane</td>
          <td>NULL</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Alex</td>
          <td>2</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Bill</td>
          <td>NULL</td>
      </tr>
      <tr>
          <td>5</td>
          <td>Zack</td>
          <td>1</td>
      </tr>
      <tr>
          <td>6</td>
          <td>Mark</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p>Write a query to return the list of <strong>customers NOT referred by the person with id <code>2</code></strong>.</p>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Will</td>
      </tr>
      <tr>
          <td>Jane</td>
      </tr>
      <tr>
          <td>Bill</td>
      </tr>
      <tr>
          <td>Zack</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">customer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">referee_id</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">referee_id</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="586-customer-placing-the-largest-number-of-orders">586. Customer Placing the Largest Number of Orders</h2>
<h4 id="description-16">Description</h4>
<p>Query the <code>customer_number</code> from the <strong>orders</strong> table for the customer who has placed the <strong>largest number of orders</strong>.<br>
It is guaranteed that exactly one customer will have placed more orders than any other customer.</p>
<p><strong>Table: orders</strong></p>
<table>
  <thead>
      <tr>
          <th>Column</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>order_number (PK)</td>
          <td>int</td>
      </tr>
      <tr>
          <td>customer_number</td>
          <td>int</td>
      </tr>
      <tr>
          <td>order_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>required_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>shipped_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>status</td>
          <td>char(15)</td>
      </tr>
      <tr>
          <td>comment</td>
          <td>char(200)</td>
      </tr>
  </tbody>
</table>
<p><strong>Example data</strong></p>
<table>
  <thead>
      <tr>
          <th>order_number</th>
          <th>customer_number</th>
          <th>order_date</th>
          <th>required_date</th>
          <th>shipped_date</th>
          <th>status</th>
          <th>comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2017-04-09</td>
          <td>2017-04-13</td>
          <td>2017-04-12</td>
          <td>Closed</td>
          <td></td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>2017-04-15</td>
          <td>2017-04-20</td>
          <td>2017-04-18</td>
          <td>Closed</td>
          <td></td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>2017-04-16</td>
          <td>2017-04-25</td>
          <td>2017-04-20</td>
          <td>Closed</td>
          <td></td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2017-04-18</td>
          <td>2017-04-28</td>
          <td>2017-04-25</td>
          <td>Closed</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>customer_number</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>3</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong><br>
Customer &lsquo;3&rsquo; has 2 orders, which is greater than customer &lsquo;1&rsquo; or &lsquo;2&rsquo;, who each have only 1 order.</p>
<p><strong>Follow-up:</strong><br>
If more than one customer has the largest number of orders, the query can return all such <code>customer_number</code>.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">customer_number</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">customer_number</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cnt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">orders</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">customer_number</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">cnt</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="595-big-countries">595. Big Countries</h2>
<h4 id="description-17">Description</h4>
<p>There is a table <strong>World</strong>:</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>continent</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>area</td>
          <td>int</td>
      </tr>
      <tr>
          <td>population</td>
          <td>int</td>
      </tr>
      <tr>
          <td>gdp</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p>A country is <strong>big</strong> if it has <strong>an area bigger than 3 million sq km</strong> or <strong>a population of more than 25 million</strong>.</p>
<p>Write a SQL query to output <strong>big countries&rsquo; name, population, and area</strong>.</p>
<p><strong>Example data</strong></p>
<table>
  <thead>
      <tr>
          <th>name</th>
          <th>continent</th>
          <th>area</th>
          <th>population</th>
          <th>gdp</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Afghanistan</td>
          <td>Asia</td>
          <td>652230</td>
          <td>25500100</td>
          <td>20343000</td>
      </tr>
      <tr>
          <td>Albania</td>
          <td>Europe</td>
          <td>28748</td>
          <td>2831741</td>
          <td>12960000</td>
      </tr>
      <tr>
          <td>Algeria</td>
          <td>Africa</td>
          <td>2381741</td>
          <td>37100000</td>
          <td>188681000</td>
      </tr>
      <tr>
          <td>Andorra</td>
          <td>Europe</td>
          <td>468</td>
          <td>78115</td>
          <td>3712000</td>
      </tr>
      <tr>
          <td>Angola</td>
          <td>Africa</td>
          <td>1246700</td>
          <td>20609294</td>
          <td>100990000</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>name</th>
          <th>population</th>
          <th>area</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Afghanistan</td>
          <td>25500100</td>
          <td>652230</td>
      </tr>
      <tr>
          <td>Algeria</td>
          <td>37100000</td>
          <td>2381741</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">,</span><span class="w"> </span><span class="n">area</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">World</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">area</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3000000</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">population</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">25000000</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="596-classes-more-than-5-students">596. Classes More Than 5 Students</h2>
<h4 id="description-18">Description</h4>
<p>There is a table <strong>courses</strong> with columns <code>student</code> and <code>class</code>.<br>
List out all <strong>classes</strong> which have <strong>5 or more students</strong>.<br>
Duplicate students in a class should <strong>not</strong> be counted.</p>
<p><strong>Example data</strong></p>
<table>
  <thead>
      <tr>
          <th>student</th>
          <th>class</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>A</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>B</td>
          <td>English</td>
      </tr>
      <tr>
          <td>C</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>D</td>
          <td>Biology</td>
      </tr>
      <tr>
          <td>E</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>F</td>
          <td>Computer</td>
      </tr>
      <tr>
          <td>G</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>H</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>I</td>
          <td>Math</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>class</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Math</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">courses</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">student</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="597-friend-requests-i-overall-acceptance-rate">597. Friend Requests I: Overall Acceptance Rate</h2>
<h4 id="description-19">Description</h4>
<p>In a social network, people send friend requests and accept others’ requests.<br>
Given two tables:</p>
<p><strong>Table: friend_request</strong></p>
<table>
  <thead>
      <tr>
          <th>sender_id</th>
          <th>send_to_id</th>
          <th>request_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-06-01</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
          <td>2016-06-01</td>
      </tr>
      <tr>
          <td>1</td>
          <td>4</td>
          <td>2016-06-01</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
          <td>2016-06-02</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2016-06-09</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: request_accepted</strong></p>
<table>
  <thead>
      <tr>
          <th>requester_id</th>
          <th>accepter_id</th>
          <th>accept_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2016-06-03</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
          <td>2016-06-08</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
          <td>2016-06-08</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2016-06-09</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2016-06-10</td>
      </tr>
  </tbody>
</table>
<p>Write a query to find the <strong>overall acceptance rate of requests</strong> rounded to 2 decimals:<br>
<code>accept_rate = number of unique accepted requests ÷ number of unique requests</code>.</p>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>accept_rate</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0.80</td>
      </tr>
  </tbody>
</table>
<p><strong>Note:</strong></p>
<ul>
<li>Only <strong>distinct</strong> requests and acceptances are counted.</li>
<li>If there are no requests, return <code>0.00</code>.</li>
<li>Accepted requests may not appear in the <code>friend_request</code> table.</li>
</ul>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">requests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">accepts</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">requests</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">accept_rate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">sender_id</span><span class="p">,</span><span class="w"> </span><span class="n">send_to_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">requests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">friend_request</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">requester_id</span><span class="p">,</span><span class="w"> </span><span class="n">accepter_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">accepts</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">request_accepted</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="603-consecutive-available-seats">603. Consecutive Available Seats</h2>
<h4 id="description-20">Description</h4>
<p>Several friends at a cinema want to reserve <strong>consecutive available seats</strong>.<br>
Given a table <strong>cinema</strong>:</p>
<table>
  <thead>
      <tr>
          <th>seat_id</th>
          <th>free</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>0</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>1</td>
      </tr>
      <tr>
          <td>5</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>seat_id</code> is an auto-increment integer.</li>
<li><code>free</code> is a boolean (<code>1</code> = free, <code>0</code> = occupied).</li>
<li>Consecutive available seats are <strong>2 or more consecutive free seats</strong>.</li>
</ul>
<p>Return all consecutive available seats <strong>ordered by <code>seat_id</code></strong>.</p>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>seat_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>3</td>
      </tr>
      <tr>
          <td>4</td>
      </tr>
      <tr>
          <td>5</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">seat_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c3</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="k">free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="k">free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">c3</span><span class="p">.</span><span class="k">free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- Alternative solution
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="n">seat_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="k">free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="k">free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">seat_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="k">free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="k">free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">c1</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span><span class="p">.</span><span class="n">seat_id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">seat_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="607-sales-person">607. Sales Person</h2>
<h4 id="description-21">Description</h4>
<p>Given three tables: <strong>salesperson</strong>, <strong>company</strong>, and <strong>orders</strong>,<br>
output all salesperson names who <strong>did not have sales</strong> to company <code>'RED'</code>.</p>
<p><strong>Table: salesperson</strong></p>
<table>
  <thead>
      <tr>
          <th>sales_id</th>
          <th>name</th>
          <th>salary</th>
          <th>commission_rate</th>
          <th>hire_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>John</td>
          <td>100000</td>
          <td>6</td>
          <td>4/1/2006</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Amy</td>
          <td>120000</td>
          <td>5</td>
          <td>5/1/2010</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Mark</td>
          <td>65000</td>
          <td>12</td>
          <td>12/25/2008</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Pam</td>
          <td>25000</td>
          <td>25</td>
          <td>1/1/2005</td>
      </tr>
      <tr>
          <td>5</td>
          <td>Alex</td>
          <td>50000</td>
          <td>10</td>
          <td>2/3/2007</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: company</strong></p>
<table>
  <thead>
      <tr>
          <th>com_id</th>
          <th>name</th>
          <th>city</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>RED</td>
          <td>Boston</td>
      </tr>
      <tr>
          <td>2</td>
          <td>ORANGE</td>
          <td>New York</td>
      </tr>
      <tr>
          <td>3</td>
          <td>YELLOW</td>
          <td>Boston</td>
      </tr>
      <tr>
          <td>4</td>
          <td>GREEN</td>
          <td>Austin</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: orders</strong></p>
<table>
  <thead>
      <tr>
          <th>order_id</th>
          <th>order_date</th>
          <th>com_id</th>
          <th>sales_id</th>
          <th>amount</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1/1/2014</td>
          <td>3</td>
          <td>4</td>
          <td>100000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2/1/2014</td>
          <td>4</td>
          <td>5</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3/1/2014</td>
          <td>1</td>
          <td>1</td>
          <td>50000</td>
      </tr>
      <tr>
          <td>4</td>
          <td>4/1/2014</td>
          <td>1</td>
          <td>4</td>
          <td>25000</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Amy</td>
      </tr>
      <tr>
          <td>Mark</td>
      </tr>
      <tr>
          <td>Alex</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong><br>
Only &lsquo;John&rsquo; and &lsquo;Pam&rsquo; have sales to <code>'RED'</code>. Output all other salesperson names.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">salesperson</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sales_id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">sales_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">o</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">company</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">com_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">com_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;RED&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="608-tree-node">608. Tree Node</h2>
<h4 id="description-22">Description</h4>
<p>Given a table <strong>tree</strong> where <code>id</code> is the identifier of a tree node and <code>p_id</code> is its parent node&rsquo;s id:</p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>p_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>null</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>2</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p>Each node can be one of three types:</p>
<ul>
<li><strong>Leaf</strong>: Node with no children.</li>
<li><strong>Root</strong>: Node with no parent.</li>
<li><strong>Inner</strong>: Node with parent and at least one child.</li>
</ul>
<p>Write a query to print the node <code>id</code> and its <code>Type</code>. Sort output by <code>id</code>.</p>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Root</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Inner</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Leaf</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Leaf</td>
      </tr>
      <tr>
          <td>5</td>
          <td>Leaf</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong></p>
<ul>
<li>Node <code>1</code> is <strong>Root</strong> because its parent is <code>NULL</code>.</li>
<li>Node <code>2</code> is <strong>Inner</strong> because it has a parent and children.</li>
<li>Nodes <code>3</code>, <code>4</code>, and <code>5</code> are <strong>Leaf</strong> because they have a parent and no children.</li>
</ul>
<p>Tree visualization:</p>
<pre class="mermaid align-center ">graph TD
    n1[1]
    n2[2]
    n3[3]
    n4[4]
    n5[5]

    n1 --&gt; n2
    n1 --&gt; n3
    n2 --&gt; n4
    n2 --&gt; n5</pre>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;Root&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">p_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;Inner&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;Leaf&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">Type</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="610-triangle-judgement">610. Triangle Judgement</h2>
<h4 id="description-23">Description</h4>
<p>Given a table <strong>triangle</strong> with columns <code>x</code>, <code>y</code>, and <code>z</code> representing the lengths of three sides,<br>
write a query to determine whether the sides can form a triangle.</p>
<table>
  <thead>
      <tr>
          <th>x</th>
          <th>y</th>
          <th>z</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>13</td>
          <td>15</td>
          <td>30</td>
      </tr>
      <tr>
          <td>10</td>
          <td>20</td>
          <td>15</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>x</th>
          <th>y</th>
          <th>z</th>
          <th>triangle</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>13</td>
          <td>15</td>
          <td>30</td>
          <td>No</td>
      </tr>
      <tr>
          <td>10</td>
          <td>20</td>
          <td>15</td>
          <td>Yes</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong><br>
A triangle is valid if the sum of any two sides is greater than the third side.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;Yes&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;No&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">triangle</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">triangle</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="612-shortest-distance-in-a-plane">612. Shortest Distance in a Plane</h2>
<h4 id="description-24">Description</h4>
<p>Given a table <strong>point_2d</strong> with coordinates <code>(x, y)</code> of unique points in a plane,<br>
write a query to find the shortest distance between any two points, rounded to 2 decimals.</p>
<table>
  <thead>
      <tr>
          <th>x</th>
          <th>y</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>-1</td>
          <td>-1</td>
      </tr>
      <tr>
          <td>0</td>
          <td>0</td>
      </tr>
      <tr>
          <td>-1</td>
          <td>-2</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>shortest</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1.00</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong><br>
The shortest distance is <code>1.00</code>, between points <code>(-1,-1)</code> and <code>(-1,-2)</code>.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="k">MIN</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">shortest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="n">SQRT</span><span class="p">(</span><span class="n">POWER</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">POWER</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dist</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">point_2d</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">point_2d</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="613-shortest-distance-in-a-line">613. Shortest Distance in a Line</h2>
<h4 id="description-25">Description</h4>
<p>Given a table <strong>point</strong> with the x-coordinates of unique points on the x-axis,<br>
write a query to find the shortest distance between any two points.</p>
<table>
  <thead>
      <tr>
          <th>x</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>-1</td>
      </tr>
      <tr>
          <td>0</td>
      </tr>
      <tr>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>shortest</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong><br>
The shortest distance is <code>1</code>, between points <code>-1</code> and <code>0</code>.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="k">ABS</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">shortest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="619-biggest-single-number">619. Biggest Single Number</h2>
<h4 id="description-26">Description</h4>
<p>Given a table <strong>my_numbers</strong> containing numbers in column <code>num</code> (may include duplicates),<br>
write a query to find the largest number that appears only once.</p>
<table>
  <thead>
      <tr>
          <th>num</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>8</td>
      </tr>
      <tr>
          <td>8</td>
      </tr>
      <tr>
          <td>3</td>
      </tr>
      <tr>
          <td>3</td>
      </tr>
      <tr>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
      </tr>
      <tr>
          <td>5</td>
      </tr>
      <tr>
          <td>6</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table</strong></p>
<table>
  <thead>
      <tr>
          <th>num</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>6</td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation:</strong><br>
The number <code>6</code> is the largest number that appears exactly once.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">num</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">my_numbers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">num</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">n</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="620-not-boring-movies">620. Not Boring Movies</h2>
<h4 id="description-27">Description</h4>
<p>Given a table <strong>cinema</strong> with columns <code>id</code>, <code>movie</code>, <code>description</code>, and <code>rating</code>,<br>
write a query to output movies with <strong>odd-numbered IDs</strong> and a description that is <strong>not &lsquo;boring&rsquo;</strong>, ordered by <code>rating</code> descending.</p>
<p><strong>Table: cinema</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>movie</th>
          <th>description</th>
          <th>rating</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>War</td>
          <td>great 3D</td>
          <td>8.9</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Science</td>
          <td>fiction</td>
          <td>8.5</td>
      </tr>
      <tr>
          <td>3</td>
          <td>irish</td>
          <td>boring</td>
          <td>6.2</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Ice song</td>
          <td>Fantacy</td>
          <td>8.6</td>
      </tr>
      <tr>
          <td>5</td>
          <td>House card</td>
          <td>Interesting</td>
          <td>9.1</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected output</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>movie</th>
          <th>description</th>
          <th>rating</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>5</td>
          <td>House card</td>
          <td>Interesting</td>
          <td>9.1</td>
      </tr>
      <tr>
          <td>1</td>
          <td>War</td>
          <td>great 3D</td>
          <td>8.9</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">movie</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="n">rating</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">cinema</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s1">&#39;boring&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">rating</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="626-exchange-seats">626. Exchange Seats</h2>
<h4 id="description-28">Description</h4>
<p>Given a table <strong>seat</strong> with columns <code>id</code> and <code>student</code>, Mary wants to swap seats for adjacent students.<br>
If the number of students is odd, the last student keeps their seat.</p>
<p><strong>Table: seat</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>student</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Abbot</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Doris</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Emerson</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Green</td>
      </tr>
      <tr>
          <td>5</td>
          <td>Jeames</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected output</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>student</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Doris</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Abbot</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Green</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Emerson</td>
      </tr>
      <tr>
          <td>5</td>
          <td>Jeames</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="k">MOD</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">seat</span><span class="p">),</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">student</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">seat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="627-swap-salary">627. Swap Salary</h2>
<h4 id="description-29">Description</h4>
<p>Given a table <strong>salary</strong> with a <code>sex</code> column containing <code>'m'</code> or <code>'f'</code>, swap all values: <code>'m'</code> → <code>'f'</code> and <code>'f'</code> → <code>'m'</code> using a single update statement.</p>
<p><strong>Table: salary</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>name</th>
          <th>sex</th>
          <th>salary</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>A</td>
          <td>m</td>
          <td>2500</td>
      </tr>
      <tr>
          <td>2</td>
          <td>B</td>
          <td>f</td>
          <td>1500</td>
      </tr>
      <tr>
          <td>3</td>
          <td>C</td>
          <td>m</td>
          <td>5500</td>
      </tr>
      <tr>
          <td>4</td>
          <td>D</td>
          <td>f</td>
          <td>500</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected output after update</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>name</th>
          <th>sex</th>
          <th>salary</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>A</td>
          <td>f</td>
          <td>2500</td>
      </tr>
      <tr>
          <td>2</td>
          <td>B</td>
          <td>m</td>
          <td>1500</td>
      </tr>
      <tr>
          <td>3</td>
          <td>C</td>
          <td>f</td>
          <td>5500</td>
      </tr>
      <tr>
          <td>4</td>
          <td>D</td>
          <td>m</td>
          <td>500</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">salary</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1045-customers-who-bought-all-products">1045. Customers Who Bought All Products</h2>
<h4 id="description-30">Description</h4>
<p>Given two tables <strong>Customer</strong> and <strong>Product</strong>, write an SQL query to find customers who bought <strong>all</strong> the products available in the Product table.</p>
<p><strong>Table: Customer</strong></p>
<table>
  <thead>
      <tr>
          <th>customer_id</th>
          <th>product_key</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>5</td>
      </tr>
      <tr>
          <td>2</td>
          <td>6</td>
      </tr>
      <tr>
          <td>3</td>
          <td>5</td>
      </tr>
      <tr>
          <td>3</td>
          <td>6</td>
      </tr>
      <tr>
          <td>1</td>
          <td>6</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Product</strong></p>
<table>
  <thead>
      <tr>
          <th>product_key</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>5</td>
      </tr>
      <tr>
          <td>6</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>customer_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
      </tr>
  </tbody>
</table>
<p>The customers who bought all the products (5 and 6) are customers with id <code>1</code> and <code>3</code>.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">customer_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Customer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">customer_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">product_key</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">product_key</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Product</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1050-actors-and-directors-who-cooperated-at-least-three-times">1050. Actors and Directors Who Cooperated At Least Three Times</h2>
<h4 id="description-31">Description</h4>
<p>Given a table <strong>ActorDirector</strong>, write an SQL query to find the pairs <code>(actor_id, director_id)</code> where the actor has cooperated with the director at least <strong>3 times</strong>.</p>
<p><strong>Table: ActorDirector</strong></p>
<table>
  <thead>
      <tr>
          <th>actor_id</th>
          <th>director_id</th>
          <th>timestamp</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>0</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>3</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>4</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
          <td>5</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
          <td>6</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>actor_id</th>
          <th>director_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>The only pair is <code>(1, 1)</code> where they cooperated exactly 3 times.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">actor_id</span><span class="p">,</span><span class="w"> </span><span class="n">director_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">ActorDirector</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">actor_id</span><span class="p">,</span><span class="w"> </span><span class="n">director_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1068-product-sales-analysis-i">1068. Product Sales Analysis I</h2>
<h4 id="description-32">Description</h4>
<p>Given two tables <strong>Sales</strong> and <strong>Product</strong>, write an SQL query to report all product names of the products in the Sales table along with their selling year and price.</p>
<p><strong>Table: Sales</strong></p>
<table>
  <thead>
      <tr>
          <th>sale_id</th>
          <th>product_id</th>
          <th>year</th>
          <th>quantity</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>100</td>
          <td>2008</td>
          <td>10</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>100</td>
          <td>2009</td>
          <td>12</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>7</td>
          <td>200</td>
          <td>2011</td>
          <td>15</td>
          <td>9000</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Product</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>100</td>
          <td>Nokia</td>
      </tr>
      <tr>
          <td>200</td>
          <td>Apple</td>
      </tr>
      <tr>
          <td>300</td>
          <td>Samsung</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>product_name</th>
          <th>year</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Nokia</td>
          <td>2008</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>Nokia</td>
          <td>2009</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>Apple</td>
          <td>2011</td>
          <td>9000</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">P</span><span class="p">.</span><span class="n">product_name</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">.</span><span class="n">price</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">product_id</span><span class="p">,</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="p">)</span><span class="w"> </span><span class="n">S</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Product</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">P</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">USING</span><span class="w"> </span><span class="p">(</span><span class="n">product_id</span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1069-product-sales-analysis-ii">1069. Product Sales Analysis II</h2>
<h4 id="description-33">Description</h4>
<p>Given two tables <strong>Sales</strong> and <strong>Product</strong>, write an SQL query to report the <strong>total quantity sold</strong> for every product id.</p>
<p><strong>Table: Sales</strong></p>
<table>
  <thead>
      <tr>
          <th>sale_id</th>
          <th>product_id</th>
          <th>year</th>
          <th>quantity</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>100</td>
          <td>2008</td>
          <td>10</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>100</td>
          <td>2009</td>
          <td>12</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>7</td>
          <td>200</td>
          <td>2011</td>
          <td>15</td>
          <td>9000</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Product</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>100</td>
          <td>Nokia</td>
      </tr>
      <tr>
          <td>200</td>
          <td>Apple</td>
      </tr>
      <tr>
          <td>300</td>
          <td>Samsung</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>total_quantity</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>100</td>
          <td>22</td>
      </tr>
      <tr>
          <td>200</td>
          <td>15</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">product_id</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_quantity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">product_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1070-product-sales-analysis-iii">1070. Product Sales Analysis III</h2>
<h4 id="description-34">Description</h4>
<p>Given two tables <strong>Sales</strong> and <strong>Product</strong>, write an SQL query to select the <strong>product id, year, quantity, and price for the first year</strong> of every product sold.</p>
<p><strong>Table: Sales</strong></p>
<table>
  <thead>
      <tr>
          <th>sale_id</th>
          <th>product_id</th>
          <th>year</th>
          <th>quantity</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>100</td>
          <td>2008</td>
          <td>10</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>100</td>
          <td>2009</td>
          <td>12</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>7</td>
          <td>200</td>
          <td>2011</td>
          <td>15</td>
          <td>9000</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Product</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>100</td>
          <td>Nokia</td>
      </tr>
      <tr>
          <td>200</td>
          <td>Apple</td>
      </tr>
      <tr>
          <td>300</td>
          <td>Samsung</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>first_year</th>
          <th>quantity</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>100</td>
          <td>2008</td>
          <td>10</td>
          <td>5000</td>
      </tr>
      <tr>
          <td>200</td>
          <td>2011</td>
          <td>15</td>
          <td>9000</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">product_id</span><span class="p">,</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">first_year</span><span class="p">,</span><span class="w"> </span><span class="n">quantity</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">product_id</span><span class="p">,</span><span class="w"> </span><span class="k">year</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">product_id</span><span class="p">,</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="k">year</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1075-project-employees-i">1075. Project Employees I</h2>
<h4 id="description-35">Description</h4>
<p>Given two tables <strong>Project</strong> and <strong>Employee</strong>, write an SQL query to report the <strong>average experience years</strong> of all the employees for each project, rounded to 2 digits.</p>
<p><strong>Table: Project</strong></p>
<table>
  <thead>
      <tr>
          <th>project_id</th>
          <th>employee_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>employee_id</th>
          <th>name</th>
          <th>experience_years</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Khaled</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Ali</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
          <td>John</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Doe</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>project_id</th>
          <th>average_years</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2.00</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2.50</td>
      </tr>
  </tbody>
</table>
<p>The average experience years for the first project is <code>(3 + 2 + 1) / 3 = 2.00</code> and for the second project is <code>(3 + 2) / 2 = 2.50</code>.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">project_id</span><span class="p">,</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">experience_years</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average_years</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Project</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">employee_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">project_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1076-project-employees-ii">1076. Project Employees II</h2>
<h4 id="description-36">Description</h4>
<p>Given two tables <strong>Project</strong> and <strong>Employee</strong>, write an SQL query to report all the projects that have the <strong>most employees</strong>.</p>
<p><strong>Table: Project</strong></p>
<table>
  <thead>
      <tr>
          <th>project_id</th>
          <th>employee_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>employee_id</th>
          <th>name</th>
          <th>experience_years</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Khaled</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Ali</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
          <td>John</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Doe</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>project_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>The first project has 3 employees while the second one has 2.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">project_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Project</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">project_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">employee_id</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">employee_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cnt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Project</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">project_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1077-project-employees-iii">1077. Project Employees III</h2>
<h4 id="description-37">Description</h4>
<p>Given two tables <strong>Project</strong> and <strong>Employee</strong>, write an SQL query to report the <strong>most experienced employees in each project</strong>. In case of a tie, report all employees with the maximum number of experience years.</p>
<p><strong>Table: Project</strong></p>
<table>
  <thead>
      <tr>
          <th>project_id</th>
          <th>employee_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Employee</strong></p>
<table>
  <thead>
      <tr>
          <th>employee_id</th>
          <th>name</th>
          <th>experience_years</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Khaled</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Ali</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
          <td>John</td>
          <td>3</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Doe</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>project_id</th>
          <th>employee_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>Both employees with id 1 and 3 have the most experience among the employees of the first project. For the second project, the employee with id 1 has the most experience.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">project_id</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Project</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">employee_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">project_id</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">experience_years</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">project_id</span><span class="p">,</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">experience_years</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">experience_years</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Project</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">employee_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">project_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1082-sales-analysis-i">1082. Sales Analysis I</h2>
<h4 id="description-38">Description</h4>
<p>Given two tables <strong>Product</strong> and <strong>Sales</strong>, write an SQL query to report the <strong>best seller by total sales price</strong>. If there is a tie, report all of them.</p>
<p><strong>Table: Product</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
          <th>unit_price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>S8</td>
          <td>1000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>G4</td>
          <td>800</td>
      </tr>
      <tr>
          <td>3</td>
          <td>iPhone</td>
          <td>1400</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Sales</strong></p>
<table>
  <thead>
      <tr>
          <th>seller_id</th>
          <th>product_id</th>
          <th>buyer_id</th>
          <th>sale_date</th>
          <th>quantity</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>2019-01-21</td>
          <td>2</td>
          <td>2000</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2</td>
          <td>2019-02-17</td>
          <td>1</td>
          <td>800</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>3</td>
          <td>2019-06-02</td>
          <td>1</td>
          <td>800</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>4</td>
          <td>2019-05-13</td>
          <td>2</td>
          <td>2800</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>seller_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
      </tr>
  </tbody>
</table>
<p>Both sellers with id 1 and 3 sold products with the <strong>most total price</strong> of 2800.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">seller_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">seller_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_price</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">seller_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">total_price</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1083-sales-analysis-ii">1083. Sales Analysis II</h2>
<h4 id="description-39">Description</h4>
<p>Given two tables <strong>Product</strong> and <strong>Sales</strong>, write an SQL query to report the <strong>buyers who have bought S8 but not iPhone</strong>.</p>
<p><strong>Table: Product</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
          <th>unit_price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>S8</td>
          <td>1000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>G4</td>
          <td>800</td>
      </tr>
      <tr>
          <td>3</td>
          <td>iPhone</td>
          <td>1400</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Sales</strong></p>
<table>
  <thead>
      <tr>
          <th>seller_id</th>
          <th>product_id</th>
          <th>buyer_id</th>
          <th>sale_date</th>
          <th>quantity</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>2019-01-21</td>
          <td>2</td>
          <td>2000</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2</td>
          <td>2019-02-17</td>
          <td>1</td>
          <td>800</td>
      </tr>
      <tr>
          <td>2</td>
          <td>1</td>
          <td>3</td>
          <td>2019-06-02</td>
          <td>1</td>
          <td>800</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>3</td>
          <td>2019-05-13</td>
          <td>2</td>
          <td>2800</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>buyer_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>The buyer with id 1 bought an S8 but didn&rsquo;t buy an iPhone. The buyer with id 3 bought both.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">buyer_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">product_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;S8&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">buyer_id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">SELECT</span><span class="w"> </span><span class="n">buyer_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">WHERE</span><span class="w"> </span><span class="n">product_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;iPhone&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1084-sales-analysis-iii">1084. Sales Analysis III</h2>
<h4 id="description-40">Description</h4>
<p>Given two tables <strong>Product</strong> and <strong>Sales</strong>, write an SQL query to report the products that were <strong>only sold in spring 2019</strong> (between 2019-01-01 and 2019-03-31 inclusive).</p>
<p><strong>Table: Product</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
          <th>unit_price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>S8</td>
          <td>1000</td>
      </tr>
      <tr>
          <td>2</td>
          <td>G4</td>
          <td>800</td>
      </tr>
      <tr>
          <td>3</td>
          <td>iPhone</td>
          <td>1400</td>
      </tr>
  </tbody>
</table>
<p><strong>Table: Sales</strong></p>
<table>
  <thead>
      <tr>
          <th>seller_id</th>
          <th>product_id</th>
          <th>buyer_id</th>
          <th>sale_date</th>
          <th>quantity</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>2019-01-21</td>
          <td>2</td>
          <td>2000</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>2</td>
          <td>2019-02-17</td>
          <td>1</td>
          <td>800</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>3</td>
          <td>2019-06-02</td>
          <td>1</td>
          <td>800</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>4</td>
          <td>2019-05-13</td>
          <td>2</td>
          <td>2800</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>S8</td>
      </tr>
  </tbody>
</table>
<p>The product with id 1 was <strong>only sold in spring 2019</strong>, while the other products were sold after.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">product_id</span><span class="p">,</span><span class="w"> </span><span class="n">product_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="k">USING</span><span class="p">(</span><span class="n">product_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">sale_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-03-31&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">sale_date</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1112-highest-grade-for-each-student">1112. Highest Grade For Each Student</h2>
<h4 id="description-41">Description</h4>
<p>Given a table <strong>Enrollments</strong>, write an SQL query to find the <strong>highest grade with its corresponding course</strong> for each student. In case of a tie, select the course with the <strong>smallest course_id</strong>. The output must be sorted by <strong>increasing student_id</strong>.</p>
<p><strong>Table: Enrollments</strong></p>
<table>
  <thead>
      <tr>
          <th>student_id</th>
          <th>course_id</th>
          <th>grade</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>95</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
          <td>95</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>90</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>99</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
          <td>80</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2</td>
          <td>75</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>82</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>student_id</th>
          <th>course_id</th>
          <th>grade</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>99</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>95</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>82</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">course_id</span><span class="p">,</span><span class="w"> </span><span class="n">grade</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Enrollments</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">grade</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">grade</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Enrollments</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1113-reported-posts">1113. Reported Posts</h2>
<h4 id="description-42">Description</h4>
<p>Given a table <strong>Actions</strong>, write an SQL query that reports the <strong>number of posts reported yesterday for each report reason</strong>. Assume today is 2019-07-05.</p>
<p><strong>Table: Actions</strong></p>
<table>
  <thead>
      <tr>
          <th>user_id</th>
          <th>post_id</th>
          <th>action_date</th>
          <th>action</th>
          <th>extra</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-01</td>
          <td>view</td>
          <td>null</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-01</td>
          <td>like</td>
          <td>null</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-01</td>
          <td>share</td>
          <td>null</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-04</td>
          <td>view</td>
          <td>null</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-04</td>
          <td>report</td>
          <td>spam</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2019-07-04</td>
          <td>view</td>
          <td>null</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>2019-07-04</td>
          <td>report</td>
          <td>spam</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-07-02</td>
          <td>view</td>
          <td>null</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-07-02</td>
          <td>report</td>
          <td>spam</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2</td>
          <td>2019-07-04</td>
          <td>view</td>
          <td>null</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2</td>
          <td>2019-07-04</td>
          <td>report</td>
          <td>racism</td>
      </tr>
      <tr>
          <td>5</td>
          <td>5</td>
          <td>2019-07-04</td>
          <td>view</td>
          <td>null</td>
      </tr>
      <tr>
          <td>5</td>
          <td>5</td>
          <td>2019-07-04</td>
          <td>report</td>
          <td>racism</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>report_reason</th>
          <th>report_count</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>spam</td>
          <td>1</td>
      </tr>
      <tr>
          <td>racism</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p>We only count reports <strong>from yesterday</strong> (2019-07-04).</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">report_reason</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">post_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">report_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Actions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">action_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2019-07-04&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;report&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">extra</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1126-active-businesses">1126. Active Businesses</h2>
<h4 id="description-43">Description</h4>
<p>Given a table <strong>Events</strong>, write an SQL query to find all <strong>active businesses</strong>.</p>
<p>An active business is a business that has <strong>more than one event type</strong> with <strong>occurences greater than the average occurences of that event type among all businesses</strong>.</p>
<p><strong>Table: Events</strong></p>
<table>
  <thead>
      <tr>
          <th>business_id</th>
          <th>event_type</th>
          <th>occurences</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>reviews</td>
          <td>7</td>
      </tr>
      <tr>
          <td>3</td>
          <td>reviews</td>
          <td>3</td>
      </tr>
      <tr>
          <td>1</td>
          <td>ads</td>
          <td>11</td>
      </tr>
      <tr>
          <td>2</td>
          <td>ads</td>
          <td>7</td>
      </tr>
      <tr>
          <td>3</td>
          <td>ads</td>
          <td>6</td>
      </tr>
      <tr>
          <td>1</td>
          <td>page views</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>page views</td>
          <td>12</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>business_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>Average for &lsquo;reviews&rsquo;, &lsquo;ads&rsquo; and &lsquo;page views&rsquo; are (7+3)/2=5, (11+7+6)/3=8, (3+12)/2=7.5 respectively.<br>
Business with id 1 has 7 &lsquo;reviews&rsquo; events (&gt;5) and 11 &lsquo;ads&rsquo; events (&gt;8), so it is an active business.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">business_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Events</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">event_type</span><span class="p">,</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">occurences</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_occurences</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Events</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">event_type</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">event_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">event_type</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">occurences</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">avg_occurences</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">business_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1141-user-activity-for-the-past-30-days-i">1141. User Activity for the Past 30 Days I</h2>
<h4 id="description-44">Description</h4>
<p>Given a table <strong>Activity</strong>, write an SQL query to find the <strong>daily active user count</strong> for a period of 30 days ending <strong>2019-07-27</strong> inclusively.<br>
A user is considered active on a day if they performed <strong>at least one activity</strong> on that day.</p>
<p><strong>Table: Activity</strong></p>
<table>
  <thead>
      <tr>
          <th>user_id</th>
          <th>session_id</th>
          <th>activity_date</th>
          <th>activity_type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-20</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-20</td>
          <td>scroll_down</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-20</td>
          <td>end_session</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-20</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-21</td>
          <td>send_message</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-21</td>
          <td>end_session</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2</td>
          <td>2019-07-21</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2</td>
          <td>2019-07-21</td>
          <td>send_message</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2</td>
          <td>2019-07-21</td>
          <td>end_session</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-06-25</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-06-25</td>
          <td>end_session</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>day</th>
          <th>active_users</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2019-07-20</td>
          <td>2</td>
      </tr>
      <tr>
          <td>2019-07-21</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p>Days with zero active users are not included.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">activity_date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">day</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">user_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">active_users</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Activity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">activity_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-06-28&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-07-27&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">day</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1142-user-activity-for-the-past-30-days-ii">1142. User Activity for the Past 30 Days II</h2>
<h4 id="description-45">Description</h4>
<p>Given a table <strong>Activity</strong>, write an SQL query to find the <strong>average number of sessions per user</strong> for a period of 30 days ending <strong>2019-07-27</strong> inclusively, rounded to 2 decimal places.<br>
Only count sessions with <strong>at least one activity</strong> in that time period.</p>
<p><strong>Table: Activity</strong></p>
<table>
  <thead>
      <tr>
          <th>user_id</th>
          <th>session_id</th>
          <th>activity_date</th>
          <th>activity_type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-20</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-20</td>
          <td>scroll_down</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-07-20</td>
          <td>end_session</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-20</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-21</td>
          <td>send_message</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>2019-07-21</td>
          <td>end_session</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2</td>
          <td>2019-07-21</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2</td>
          <td>2019-07-21</td>
          <td>send_message</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2</td>
          <td>2019-07-21</td>
          <td>end_session</td>
      </tr>
      <tr>
          <td>3</td>
          <td>5</td>
          <td>2019-07-21</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>3</td>
          <td>5</td>
          <td>2019-07-21</td>
          <td>scroll_down</td>
      </tr>
      <tr>
          <td>3</td>
          <td>5</td>
          <td>2019-07-21</td>
          <td>end_session</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-06-25</td>
          <td>open_session</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-06-25</td>
          <td>end_session</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>average_sessions_per_user</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1.33</td>
      </tr>
  </tbody>
</table>
<p>Explanation: Users 1 and 2 each had 1 session, user 3 had 2 sessions. Average = (1+1+2)/3 = 1.33.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="n">IFNULL</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">sessions</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">user_id</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average_sessions_per_user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">session_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sessions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Activity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">activity_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-06-28&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-07-27&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1148-article-views-i">1148. Article Views I</h2>
<h4 id="description-46">Description</h4>
<p>Given a table <strong>Views</strong>, write an SQL query to find all <strong>authors who viewed at least one of their own articles</strong>, sorted in ascending order by their id.</p>
<p><strong>Table: Views</strong></p>
<table>
  <thead>
      <tr>
          <th>article_id</th>
          <th>author_id</th>
          <th>viewer_id</th>
          <th>view_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>3</td>
          <td>5</td>
          <td>2019-08-01</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
          <td>6</td>
          <td>2019-08-02</td>
      </tr>
      <tr>
          <td>2</td>
          <td>7</td>
          <td>7</td>
          <td>2019-08-01</td>
      </tr>
      <tr>
          <td>2</td>
          <td>7</td>
          <td>6</td>
          <td>2019-08-02</td>
      </tr>
      <tr>
          <td>4</td>
          <td>7</td>
          <td>1</td>
          <td>2019-07-22</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>4</td>
          <td>2019-07-21</td>
      </tr>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>4</td>
          <td>2019-07-21</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>4</td>
      </tr>
      <tr>
          <td>7</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">author_id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Views</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">author_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewer_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">author_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1164-product-price-at-a-given-date">1164. Product Price at a Given Date</h2>
<h4 id="description-47">Description</h4>
<p>Given a table <strong>Products</strong>, write an SQL query to find the <strong>prices of all products on 2019-08-16</strong>. Assume the price of all products before any change is 10.</p>
<p><strong>Table: Products</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>new_price</th>
          <th>change_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>20</td>
          <td>2019-08-14</td>
      </tr>
      <tr>
          <td>2</td>
          <td>50</td>
          <td>2019-08-14</td>
      </tr>
      <tr>
          <td>1</td>
          <td>30</td>
          <td>2019-08-15</td>
      </tr>
      <tr>
          <td>1</td>
          <td>35</td>
          <td>2019-08-16</td>
      </tr>
      <tr>
          <td>2</td>
          <td>65</td>
          <td>2019-08-17</td>
      </tr>
      <tr>
          <td>3</td>
          <td>20</td>
          <td>2019-08-18</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2</td>
          <td>50</td>
      </tr>
      <tr>
          <td>1</td>
          <td>35</td>
      </tr>
      <tr>
          <td>3</td>
          <td>10</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">i</span><span class="p">.</span><span class="n">product_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MAX</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">IF</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">i</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">SELECT</span><span class="w"> </span><span class="n">product_id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">FROM</span><span class="w"> </span><span class="n">Products</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">WHERE</span><span class="w"> </span><span class="n">change_date</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2019-08-16&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">),</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="mi">10</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">SELECT</span><span class="w"> </span><span class="n">new_price</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">FROM</span><span class="w"> </span><span class="n">Products</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">WHERE</span><span class="w"> </span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">product_id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">AND</span><span class="w"> </span><span class="n">change_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">max_change_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">price</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">product_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Products</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">product_id</span><span class="p">,</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">change_date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">max_change_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Products</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">change_date</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="s1">&#39;2019-08-16&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">q</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">product_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1173-immediate-food-delivery-i">1173. Immediate Food Delivery I</h2>
<h4 id="description-48">Description</h4>
<p>Given a table <strong>Delivery</strong>, calculate the <strong>percentage of immediate orders</strong>. An order is immediate if <code>order_date = customer_pref_delivery_date</code>. Round the result to 2 decimal places.</p>
<p><strong>Table: Delivery</strong></p>
<table>
  <thead>
      <tr>
          <th>delivery_id</th>
          <th>customer_id</th>
          <th>order_date</th>
          <th>customer_pref_delivery_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-08-01</td>
          <td>2019-08-02</td>
      </tr>
      <tr>
          <td>2</td>
          <td>5</td>
          <td>2019-08-02</td>
          <td>2019-08-02</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
          <td>2019-08-11</td>
          <td>2019-08-11</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-08-24</td>
          <td>2019-08-26</td>
      </tr>
      <tr>
          <td>5</td>
          <td>4</td>
          <td>2019-08-21</td>
          <td>2019-08-22</td>
      </tr>
      <tr>
          <td>6</td>
          <td>2</td>
          <td>2019-08-11</td>
          <td>2019-08-13</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>immediate_percentage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>33.33</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ROUND</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">order_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_pref_delivery_date</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">END</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">/</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="n">delivery_id</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">immediate_percentage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Delivery</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1174-immediate-food-delivery-ii">1174. Immediate Food Delivery II</h2>
<h4 id="description-49">Description</h4>
<p>Given a table <strong>Delivery</strong>, calculate the <strong>percentage of immediate orders among the first orders of all customers</strong>. An order is immediate if <code>order_date = customer_pref_delivery_date</code>. Round the result to 2 decimal places. Each customer has exactly one first order (earliest <code>order_date</code>).</p>
<p><strong>Table: Delivery</strong></p>
<table>
  <thead>
      <tr>
          <th>delivery_id</th>
          <th>customer_id</th>
          <th>order_date</th>
          <th>customer_pref_delivery_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>2019-08-01</td>
          <td>2019-08-02</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>2019-08-02</td>
          <td>2019-08-02</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
          <td>2019-08-11</td>
          <td>2019-08-12</td>
      </tr>
      <tr>
          <td>4</td>
          <td>3</td>
          <td>2019-08-24</td>
          <td>2019-08-24</td>
      </tr>
      <tr>
          <td>5</td>
          <td>3</td>
          <td>2019-08-21</td>
          <td>2019-08-22</td>
      </tr>
      <tr>
          <td>6</td>
          <td>2</td>
          <td>2019-08-11</td>
          <td>2019-08-13</td>
      </tr>
      <tr>
          <td>7</td>
          <td>4</td>
          <td>2019-08-09</td>
          <td>2019-08-09</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>immediate_percentage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>50.00</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">order_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer_pref_delivery_date</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">immediate_percentage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Delivery</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">customer_id</span><span class="p">,</span><span class="w"> </span><span class="n">order_date</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">customer_id</span><span class="p">,</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">order_date</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Delivery</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">customer_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1179-reformat-department-table">1179. Reformat Department Table</h2>
<h4 id="description-50">Description</h4>
<p>Given a table <strong>Department</strong> with <code>id</code>, <code>revenue</code>, and <code>month</code>, reformat it so that each department has one row, and there is a revenue column for each month. The month values are <code>[&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;]</code>.</p>
<p><strong>Table: Department</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>revenue</th>
          <th>month</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>8000</td>
          <td>Jan</td>
      </tr>
      <tr>
          <td>2</td>
          <td>9000</td>
          <td>Jan</td>
      </tr>
      <tr>
          <td>3</td>
          <td>10000</td>
          <td>Feb</td>
      </tr>
      <tr>
          <td>1</td>
          <td>7000</td>
          <td>Feb</td>
      </tr>
      <tr>
          <td>1</td>
          <td>6000</td>
          <td>Mar</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>Jan_Revenue</th>
          <th>Feb_Revenue</th>
          <th>Mar_Revenue</th>
          <th>&hellip;</th>
          <th>Dec_Revenue</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>8000</td>
          <td>7000</td>
          <td>6000</td>
          <td>&hellip;</td>
          <td>null</td>
      </tr>
      <tr>
          <td>2</td>
          <td>9000</td>
          <td>null</td>
          <td>null</td>
          <td>&hellip;</td>
          <td>null</td>
      </tr>
      <tr>
          <td>3</td>
          <td>null</td>
          <td>10000</td>
          <td>null</td>
          <td>&hellip;</td>
          <td>null</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Jan_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Feb&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Feb_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Mar&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Mar_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Apr&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Apr_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;May&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">May_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Jun&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Jun_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Jul&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Jul_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Aug&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Aug_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Sep&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Sep_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Oct&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Oct_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Nov&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Nov_Revenue</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Dec_Revenue</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Department</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1193-monthly-transactions-i">1193. Monthly Transactions I</h2>
<h4 id="description-51">Description</h4>
<p>Given a table <strong>Transactions</strong> with <code>id</code>, <code>country</code>, <code>state</code>, <code>amount</code>, and <code>trans_date</code>, calculate for each month and country:</p>
<ul>
<li>Total number of transactions</li>
<li>Total amount of transactions</li>
<li>Number of approved transactions</li>
<li>Total amount of approved transactions</li>
</ul>
<p><strong>Table: Transactions</strong></p>
<table>
  <thead>
      <tr>
          <th>id</th>
          <th>country</th>
          <th>state</th>
          <th>amount</th>
          <th>trans_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>121</td>
          <td>US</td>
          <td>approved</td>
          <td>1000</td>
          <td>2018-12-18</td>
      </tr>
      <tr>
          <td>122</td>
          <td>US</td>
          <td>declined</td>
          <td>2000</td>
          <td>2018-12-19</td>
      </tr>
      <tr>
          <td>123</td>
          <td>US</td>
          <td>approved</td>
          <td>2000</td>
          <td>2019-01-01</td>
      </tr>
      <tr>
          <td>124</td>
          <td>DE</td>
          <td>approved</td>
          <td>2000</td>
          <td>2019-01-07</td>
      </tr>
  </tbody>
</table>
<p><strong>Expected Output</strong></p>
<table>
  <thead>
      <tr>
          <th>month</th>
          <th>country</th>
          <th>trans_count</th>
          <th>approved_count</th>
          <th>trans_total_amount</th>
          <th>approved_total_amount</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2018-12</td>
          <td>US</td>
          <td>2</td>
          <td>1</td>
          <td>3000</td>
          <td>1000</td>
      </tr>
      <tr>
          <td>2019-01</td>
          <td>US</td>
          <td>1</td>
          <td>1</td>
          <td>2000</td>
          <td>2000</td>
      </tr>
      <tr>
          <td>2019-01</td>
          <td>DE</td>
          <td>1</td>
          <td>1</td>
          <td>2000</td>
          <td>2000</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">trans_date</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">month</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">country</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">trans_count</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;approved&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">approved_count</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">trans_total_amount</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;approved&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">approved_total_amount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Transactions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">trans_date</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">country</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1204-last-person-to-fit-in-the-elevator">1204. Last Person to Fit in the Elevator</h2>
<h4 id="description-52">Description</h4>
<p>Given a table <strong>Queue</strong> with <code>person_id</code>, <code>person_name</code>, <code>weight</code>, and <code>turn</code>, find the <strong>last person</strong> who can fit in an elevator without exceeding a <strong>weight limit of 1000</strong>. People enter the elevator in the order of <code>turn</code>.</p>
<p><strong>Table: Queue</strong></p>
<table>
  <thead>
      <tr>
          <th>person_id</th>
          <th>person_name</th>
          <th>weight</th>
          <th>turn</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>5</td>
          <td>George Washington</td>
          <td>250</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>John Adams</td>
          <td>350</td>
          <td>2</td>
      </tr>
      <tr>
          <td>6</td>
          <td>Thomas Jefferson</td>
          <td>400</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Will Johnliams</td>
          <td>200</td>
          <td>4</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Thomas Jefferson</td>
          <td>175</td>
          <td>5</td>
      </tr>
      <tr>
          <td>1</td>
          <td>James Elephant</td>
          <td>500</td>
          <td>6</td>
      </tr>
  </tbody>
</table>
<p><strong>Result Table</strong></p>
<table>
  <thead>
      <tr>
          <th>person_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Thomas Jefferson</td>
      </tr>
  </tbody>
</table>
<p>Explanation: The first three people (250 + 350 + 400 = 1000) fit exactly. The last one in this group is Thomas Jefferson (turn 3).</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">person_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">person_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">total_weight</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">total_weight</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_weight</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Queue</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">total_weight</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tmp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">turn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">total_weight</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">total_weight</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1211-queries-quality-and-percentage">1211. Queries Quality and Percentage</h2>
<h4 id="description-53">Description</h4>
<p>Given a <strong>Queries</strong> table with <code>query_name</code>, <code>result</code>, <code>position</code>, and <code>rating</code>, compute for each <code>query_name</code>:</p>
<ol>
<li><strong>Quality</strong>: Average of the ratio <code>rating / position</code>.</li>
<li><strong>Poor query percentage</strong>: Percentage of queries with <code>rating &lt; 3</code>.</li>
</ol>
<p>Both metrics should be <strong>rounded to 2 decimal places</strong>.</p>
<p><strong>Example Table: Queries</strong></p>
<table>
  <thead>
      <tr>
          <th>query_name</th>
          <th>result</th>
          <th>position</th>
          <th>rating</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Dog</td>
          <td>Golden Retriever</td>
          <td>1</td>
          <td>5</td>
      </tr>
      <tr>
          <td>Dog</td>
          <td>German Shepherd</td>
          <td>2</td>
          <td>5</td>
      </tr>
      <tr>
          <td>Dog</td>
          <td>Mule</td>
          <td>200</td>
          <td>1</td>
      </tr>
      <tr>
          <td>Cat</td>
          <td>Shirazi</td>
          <td>5</td>
          <td>2</td>
      </tr>
      <tr>
          <td>Cat</td>
          <td>Siamese</td>
          <td>3</td>
          <td>3</td>
      </tr>
      <tr>
          <td>Cat</td>
          <td>Sphynx</td>
          <td>7</td>
          <td>4</td>
      </tr>
  </tbody>
</table>
<p><strong>Result Table</strong></p>
<table>
  <thead>
      <tr>
          <th>query_name</th>
          <th>quality</th>
          <th>poor_query_percentage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Dog</td>
          <td>2.50</td>
          <td>33.33</td>
      </tr>
      <tr>
          <td>Cat</td>
          <td>0.66</td>
          <td>33.33</td>
      </tr>
  </tbody>
</table>
<hr>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">query_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">rating</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">position</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">quality</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">rating</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">poor_query_percentage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Queries</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">query_name</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1212-team-scores-in-football-tournament">1212. Team Scores in Football Tournament</h2>
<h4 id="description-54">Description</h4>
<p>Table: Teams</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>team_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>team_name</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<p><code>team_id</code> is the primary key of this table. Each row of this table represents a single football team.</p>
<p>Table: Matches</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>match_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>host_team</td>
          <td>int</td>
      </tr>
      <tr>
          <td>guest_team</td>
          <td>int</td>
      </tr>
      <tr>
          <td>host_goals</td>
          <td>int</td>
      </tr>
      <tr>
          <td>guest_goals</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<p><code>match_id</code> is the primary key of this table. Each row is a record of a finished match between two different teams. Teams <code>host_team</code> and <code>guest_team</code> are represented by their IDs in the <code>Teams</code> table (<code>team_id</code>) and they scored <code>host_goals</code> and <code>guest_goals</code> respectively.</p>
<p>Points are awarded as follows:</p>
<ul>
<li>A team receives 3 points if they win a match (score strictly more goals than the opponent).</li>
<li>A team receives 1 point if they draw a match (same number of goals as the opponent).</li>
<li>A team receives 0 points if they lose a match (score less than the opponent).</li>
</ul>
<p>Write an SQL query that selects the <code>team_id</code>, <code>team_name</code>, and <code>num_points</code> of each team in the tournament after all matches. The result table should be ordered by <code>num_points</code> (descending). In case of a tie, order by <code>team_id</code> (ascending).</p>
<p><strong>Example:</strong></p>
<p>Teams table:</p>
<table>
  <thead>
      <tr>
          <th>team_id</th>
          <th>team_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>10</td>
          <td>Leetcode FC</td>
      </tr>
      <tr>
          <td>20</td>
          <td>NewYork FC</td>
      </tr>
      <tr>
          <td>30</td>
          <td>Atlanta FC</td>
      </tr>
      <tr>
          <td>40</td>
          <td>Chicago FC</td>
      </tr>
      <tr>
          <td>50</td>
          <td>Toronto FC</td>
      </tr>
  </tbody>
</table>
<p>Matches table:</p>
<table>
  <thead>
      <tr>
          <th>match_id</th>
          <th>host_team</th>
          <th>guest_team</th>
          <th>host_goals</th>
          <th>guest_goals</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>10</td>
          <td>20</td>
          <td>3</td>
          <td>0</td>
      </tr>
      <tr>
          <td>2</td>
          <td>30</td>
          <td>10</td>
          <td>2</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
          <td>10</td>
          <td>50</td>
          <td>5</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>20</td>
          <td>30</td>
          <td>1</td>
          <td>0</td>
      </tr>
      <tr>
          <td>5</td>
          <td>50</td>
          <td>30</td>
          <td>1</td>
          <td>0</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>team_id</th>
          <th>team_name</th>
          <th>num_points</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>10</td>
          <td>Leetcode FC</td>
          <td>7</td>
      </tr>
      <tr>
          <td>20</td>
          <td>NewYork FC</td>
          <td>3</td>
      </tr>
      <tr>
          <td>50</td>
          <td>Toronto FC</td>
          <td>3</td>
      </tr>
      <tr>
          <td>30</td>
          <td>Atlanta FC</td>
          <td>1</td>
      </tr>
      <tr>
          <td>40</td>
          <td>Chicago FC</td>
          <td>0</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">team_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">t</span><span class="p">.</span><span class="n">team_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">IFNULL</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">num_points</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_points</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Teams</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">team_id</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">num_points</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_points</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">-- Points as host
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">host_team</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">team_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">host_goals</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">guest_goals</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">host_goals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guest_goals</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                       </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                   </span><span class="k">END</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_points</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Matches</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">host_team</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">-- Points as guest
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">guest_team</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">team_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">host_goals</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">guest_goals</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">host_goals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guest_goals</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                       </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                   </span><span class="k">END</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">num_points</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Matches</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">guest_team</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">team_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">r</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">team_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">team_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">num_points</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">team_id</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1225-report-contiguous-dates">1225. Report Contiguous Dates</h2>
<h4 id="description-55">Description</h4>
<p>Table: Failed</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>fail_date</td>
          <td>date</td>
      </tr>
  </tbody>
</table>
<p>Primary key for this table is <code>fail_date</code>. Failed table contains the days of failed tasks.</p>
<p>Table: Succeeded</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>success_date</td>
          <td>date</td>
      </tr>
  </tbody>
</table>
<p>Primary key for this table is <code>success_date</code>. Succeeded table contains the days of succeeded tasks.</p>
<p>A system is running one task every day. Every task is independent of the previous tasks. The tasks can fail or succeed.</p>
<p>Write an SQL query to generate a report of <code>period_state</code> for each continuous interval of days in the period from <code>2019-01-01</code> to <code>2019-12-31</code>.</p>
<p><code>period_state</code> is <code>'failed'</code> if tasks in this interval failed or <code>'succeeded'</code> if tasks in this interval succeeded. Interval of days are retrieved as <code>start_date</code> and <code>end_date</code>.</p>
<p>Order result by <code>start_date</code>.</p>
<p><strong>Example:</strong></p>
<p>Failed table:</p>
<table>
  <thead>
      <tr>
          <th>fail_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2018-12-28</td>
      </tr>
      <tr>
          <td>2018-12-29</td>
      </tr>
      <tr>
          <td>2019-01-04</td>
      </tr>
      <tr>
          <td>2019-01-05</td>
      </tr>
  </tbody>
</table>
<p>Succeeded table:</p>
<table>
  <thead>
      <tr>
          <th>success_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2018-12-30</td>
      </tr>
      <tr>
          <td>2018-12-31</td>
      </tr>
      <tr>
          <td>2019-01-01</td>
      </tr>
      <tr>
          <td>2019-01-02</td>
      </tr>
      <tr>
          <td>2019-01-03</td>
      </tr>
      <tr>
          <td>2019-01-06</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>period_state</th>
          <th>start_date</th>
          <th>end_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>succeeded</td>
          <td>2019-01-01</td>
          <td>2019-01-03</td>
      </tr>
      <tr>
          <td>failed</td>
          <td>2019-01-04</td>
          <td>2019-01-05</td>
      </tr>
      <tr>
          <td>succeeded</td>
          <td>2019-01-06</td>
          <td>2019-01-06</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">period_state</span><span class="p">,</span><span class="w"> </span><span class="n">start_date</span><span class="p">,</span><span class="w"> </span><span class="n">end_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">-- Failed intervals
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;failed&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">period_state</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="p">.</span><span class="n">fail_date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">start_date</span><span class="p">,</span><span class="w"> </span><span class="n">f2</span><span class="p">.</span><span class="n">fail_date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">end_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">fail_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Failed</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">fail_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">AND</span><span class="w"> </span><span class="n">DATE_SUB</span><span class="p">(</span><span class="n">fail_date</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="k">SELECT</span><span class="w"> </span><span class="n">fail_date</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">fail_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">f1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">fail_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Failed</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">fail_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">AND</span><span class="w"> </span><span class="n">DATE_ADD</span><span class="p">(</span><span class="n">fail_date</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="k">SELECT</span><span class="w"> </span><span class="n">fail_date</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">fail_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">f2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">f1</span><span class="p">.</span><span class="n">fail_date</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">f2</span><span class="p">.</span><span class="n">fail_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">f1</span><span class="p">.</span><span class="n">fail_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">-- Succeeded intervals
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;succeeded&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">period_state</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="n">success_date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">start_date</span><span class="p">,</span><span class="w"> </span><span class="n">s2</span><span class="p">.</span><span class="n">success_date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">end_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">success_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Succeeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">success_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">AND</span><span class="w"> </span><span class="n">DATE_SUB</span><span class="p">(</span><span class="n">success_date</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="k">SELECT</span><span class="w"> </span><span class="n">success_date</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Succeeded</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">success_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">success_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Succeeded</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">success_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">AND</span><span class="w"> </span><span class="n">DATE_ADD</span><span class="p">(</span><span class="n">success_date</span><span class="p">,</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="k">SELECT</span><span class="w"> </span><span class="n">success_date</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Succeeded</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">success_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-01-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-12-31&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="n">success_date</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">s2</span><span class="p">.</span><span class="n">success_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="n">success_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">start_date</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1241-number-of-comments-per-post">1241. Number of Comments per Post</h2>
<h4 id="description-56">Description</h4>
<p>Table: Submissions</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>sub_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>parent_id</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li>There is no primary key for this table; it may have duplicate rows.</li>
<li>Each row can be a post or a comment on a post.</li>
<li><code>parent_id</code> is null for posts.</li>
<li><code>parent_id</code> for comments is the <code>sub_id</code> of another post in the table.</li>
</ul>
<p>Write an SQL query to find the number of comments per each post.</p>
<ul>
<li>Result table should contain <code>post_id</code> and its corresponding <code>number_of_comments</code>.</li>
<li>Sort the result by <code>post_id</code> in ascending order.</li>
<li>Count <strong>unique comments</strong> per post.</li>
<li>Treat duplicate posts as one post.</li>
<li>Ignore comments on posts that do not exist.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Submissions table:</p>
<table>
  <thead>
      <tr>
          <th>sub_id</th>
          <th>parent_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Null</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Null</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Null</td>
      </tr>
      <tr>
          <td>12</td>
          <td>Null</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>1</td>
      </tr>
      <tr>
          <td>9</td>
          <td>1</td>
      </tr>
      <tr>
          <td>10</td>
          <td>2</td>
      </tr>
      <tr>
          <td>6</td>
          <td>7</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>post_id</th>
          <th>number_of_comments</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
      </tr>
      <tr>
          <td>12</td>
          <td>0</td>
      </tr>
  </tbody>
</table>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">post_id</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">sub_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">number_of_comments</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">sub_id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">post_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Submissions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">parent_id</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Submissions</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">post_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">parent_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">post_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">post_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1251-average-selling-price">1251. Average Selling Price</h2>
<h4 id="description-57">Description</h4>
<p>Table: Prices</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>product_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>start_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>end_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>price</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(product_id, start_date, end_date)</code> is the primary key.</li>
<li>Each row indicates the price of the product in the period from <code>start_date</code> to <code>end_date</code>.</li>
<li>There are no overlapping periods for the same product.</li>
</ul>
<p>Table: UnitsSold</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>product_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>purchase_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>units</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li>There is no primary key; duplicates may exist.</li>
<li>Each row indicates the number of units sold for a product on a particular date.</li>
</ul>
<p>Write an SQL query to find the <strong>average selling price</strong> for each product.</p>
<ul>
<li><code>average_price</code> should be rounded to 2 decimal places.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Prices table:</p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>start_date</th>
          <th>end_date</th>
          <th>price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2019-02-17</td>
          <td>2019-02-28</td>
          <td>5</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2019-03-01</td>
          <td>2019-03-22</td>
          <td>20</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2019-02-01</td>
          <td>2019-02-20</td>
          <td>15</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2019-02-21</td>
          <td>2019-03-31</td>
          <td>30</td>
      </tr>
  </tbody>
</table>
<p>UnitsSold table:</p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>purchase_date</th>
          <th>units</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2019-02-25</td>
          <td>100</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2019-03-01</td>
          <td>15</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2019-02-10</td>
          <td>200</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2019-03-22</td>
          <td>30</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>average_price</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>6.96</td>
      </tr>
      <tr>
          <td>2</td>
          <td>16.96</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>Average selling price = Total price of product / Number of units sold</li>
<li>Product 1: <code>((100 * 5) + (15 * 20)) / 115 = 6.96</code></li>
<li>Product 2: <code>((200 * 15) + (30 * 30)) / 230 = 16.96</code></li>
</ul>
</li>
</ul>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">units</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">units</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average_price</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Prices</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">UnitsSold</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">AND</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">purchase_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">start_date</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">end_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1264-page-recommendations">1264. Page Recommendations</h2>
<h4 id="description-58">Description</h4>
<p>Table: Friendship</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>user1_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>user2_id</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(user1_id, user2_id)</code> is the primary key.</li>
<li>Each row indicates a friendship relation between <code>user1_id</code> and <code>user2_id</code>.</li>
</ul>
<p>Table: Likes</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>user_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>page_id</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(user_id, page_id)</code> is the primary key.</li>
<li>Each row indicates that <code>user_id</code> likes <code>page_id</code>.</li>
</ul>
<p>Write an SQL query to <strong>recommend pages</strong> to the user with <code>user_id = 1</code> using the pages that their friends liked.</p>
<ul>
<li>Do <strong>not</strong> recommend pages the user already liked.</li>
<li>Return the result table in any order without duplicates.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Friendship table:</p>
<table>
  <thead>
      <tr>
          <th>user1_id</th>
          <th>user2_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2</td>
      </tr>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>1</td>
          <td>4</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
      </tr>
      <tr>
          <td>2</td>
          <td>5</td>
      </tr>
      <tr>
          <td>6</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>Likes table:</p>
<table>
  <thead>
      <tr>
          <th>user_id</th>
          <th>page_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>88</td>
      </tr>
      <tr>
          <td>2</td>
          <td>23</td>
      </tr>
      <tr>
          <td>3</td>
          <td>24</td>
      </tr>
      <tr>
          <td>4</td>
          <td>56</td>
      </tr>
      <tr>
          <td>5</td>
          <td>11</td>
      </tr>
      <tr>
          <td>6</td>
          <td>33</td>
      </tr>
      <tr>
          <td>2</td>
          <td>77</td>
      </tr>
      <tr>
          <td>3</td>
          <td>77</td>
      </tr>
      <tr>
          <td>6</td>
          <td>88</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>recommended_page</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>23</td>
      </tr>
      <tr>
          <td>24</td>
      </tr>
      <tr>
          <td>56</td>
      </tr>
      <tr>
          <td>33</td>
      </tr>
      <tr>
          <td>77</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>User 1 is friends with users 2, 3, 4, and 6.</li>
<li>Suggested pages: 23 from user 2, 24 from user 3, 56 from user 4, 33 from user 6, 77 from users 2 &amp; 3.</li>
<li>Page 88 is not suggested because user 1 already likes it.</li>
</ul>
</li>
</ul>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">page_id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recommended_page</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Likes</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">l</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Friendship</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">user2_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">user1_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">page_id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">page_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Likes</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">page_id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">recommended_page</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Likes</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">l</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Friendship</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">user1_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">user2_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">page_id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">page_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Likes</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1270-all-people-report-to-the-given-manager">1270. All People Report to the Given Manager</h2>
<h4 id="description-59">Description</h4>
<p>Table: Employees</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>employee_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>employee_name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>manager_id</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>employee_id</code> is the primary key.</li>
<li>Each row indicates that the employee reports to their direct manager with <code>manager_id</code>.</li>
<li>The head of the company is the employee with <code>employee_id = 1</code>.</li>
</ul>
<p>Write an SQL query to find <code>employee_id</code> of all employees that <strong>directly or indirectly report</strong> to the head of the company.</p>
<ul>
<li>The indirect relation between managers will not exceed 3 levels.</li>
<li>Return the result table in any order without duplicates.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Employees table:</p>
<table>
  <thead>
      <tr>
          <th>employee_id</th>
          <th>employee_name</th>
          <th>manager_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Boss</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Alice</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Bob</td>
          <td>1</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Daniel</td>
          <td>2</td>
      </tr>
      <tr>
          <td>7</td>
          <td>Luis</td>
          <td>4</td>
      </tr>
      <tr>
          <td>8</td>
          <td>Jhon</td>
          <td>3</td>
      </tr>
      <tr>
          <td>9</td>
          <td>Angela</td>
          <td>8</td>
      </tr>
      <tr>
          <td>77</td>
          <td>Robert</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>employee_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2</td>
      </tr>
      <tr>
          <td>77</td>
      </tr>
      <tr>
          <td>4</td>
      </tr>
      <tr>
          <td>7</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>Employees 2 and 77 report <strong>directly</strong> to the head (1).</li>
<li>Employee 4 reports indirectly: <code>4 → 2 → 1</code>.</li>
<li>Employee 7 reports indirectly: <code>7 → 4 → 2 → 1</code>.</li>
<li>Employees 3, 8, 9 do <strong>not</strong> report to the head directly or indirectly.</li>
</ul>
</li>
</ul>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">employee_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Employees</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Employees</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Employees</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">manager_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e2</span><span class="p">.</span><span class="n">employee_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">AND</span><span class="w"> </span><span class="n">e2</span><span class="p">.</span><span class="n">manager_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e3</span><span class="p">.</span><span class="n">employee_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">e1</span><span class="p">.</span><span class="n">employee_id</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">manager_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">e2</span><span class="p">.</span><span class="n">manager_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">e3</span><span class="p">.</span><span class="n">manager_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1280-students-and-examinations">1280. Students and Examinations</h2>
<h4 id="description-60">Description</h4>
<p>Table: Students</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>student_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>student_name</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>student_id</code> is the primary key.</li>
<li>Each row contains the ID and name of a student.</li>
</ul>
<p>Table: Subjects</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>subject_name</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>subject_name</code> is the primary key.</li>
<li>Each row contains the name of a subject.</li>
</ul>
<p>Table: Examinations</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>student_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>subject_name</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<ul>
<li>There is no primary key; duplicates may exist.</li>
<li>Each student takes every subject.</li>
<li>Each row indicates that a student attended the exam of a subject.</li>
</ul>
<p>Write an SQL query to find the <strong>number of times each student attended each exam</strong>.</p>
<ul>
<li>Order the result table by <code>student_id</code> and <code>subject_name</code>.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Students table:</p>
<table>
  <thead>
      <tr>
          <th>student_id</th>
          <th>student_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Alice</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Bob</td>
      </tr>
      <tr>
          <td>13</td>
          <td>John</td>
      </tr>
      <tr>
          <td>6</td>
          <td>Alex</td>
      </tr>
  </tbody>
</table>
<p>Subjects table:</p>
<table>
  <thead>
      <tr>
          <th>subject_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Math</td>
      </tr>
      <tr>
          <td>Physics</td>
      </tr>
      <tr>
          <td>Programming</td>
      </tr>
  </tbody>
</table>
<p>Examinations table:</p>
<table>
  <thead>
      <tr>
          <th>student_id</th>
          <th>subject_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Physics</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Programming</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Programming</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Physics</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>13</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>13</td>
          <td>Programming</td>
      </tr>
      <tr>
          <td>13</td>
          <td>Physics</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Math</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Math</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>student_id</th>
          <th>student_name</th>
          <th>subject_name</th>
          <th>attended_exams</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Alice</td>
          <td>Math</td>
          <td>3</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Alice</td>
          <td>Physics</td>
          <td>2</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Alice</td>
          <td>Programming</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Bob</td>
          <td>Math</td>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Bob</td>
          <td>Physics</td>
          <td>0</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Bob</td>
          <td>Programming</td>
          <td>1</td>
      </tr>
      <tr>
          <td>6</td>
          <td>Alex</td>
          <td>Math</td>
          <td>0</td>
      </tr>
      <tr>
          <td>6</td>
          <td>Alex</td>
          <td>Physics</td>
          <td>0</td>
      </tr>
      <tr>
          <td>6</td>
          <td>Alex</td>
          <td>Programming</td>
          <td>0</td>
      </tr>
      <tr>
          <td>13</td>
          <td>John</td>
          <td>Math</td>
          <td>1</td>
      </tr>
      <tr>
          <td>13</td>
          <td>John</td>
          <td>Physics</td>
          <td>1</td>
      </tr>
      <tr>
          <td>13</td>
          <td>John</td>
          <td>Programming</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>Alice attended Math 3 times, Physics 2 times, Programming 1 time.</li>
<li>Bob attended Math and Programming once, Physics 0 times.</li>
<li>Alex did not attend any exam.</li>
<li>John attended all subjects once.</li>
</ul>
</li>
</ul>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">student_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">s</span><span class="p">.</span><span class="n">student_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">u</span><span class="p">.</span><span class="n">subject_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">COUNT</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">subject_name</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">attended_exams</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Students</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">Subjects</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Examinations</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">student_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">subject_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">subject_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">subject_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">subject_name</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>
<h2 id="1285-find-the-start-and-end-number-of-continuous-ranges">1285. Find the Start and End Number of Continuous Ranges</h2>
<h4 id="description-61">Description</h4>
<p>Table: Logs</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>log_id</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>log_id</code> is the primary key.</li>
<li>Each row contains an ID in the log table.</li>
<li>Some IDs may be missing.</li>
</ul>
<p>Write an SQL query to find the <strong>start and end number of continuous ranges</strong> in the table <code>Logs</code>.</p>
<ul>
<li>Order the result table by <code>start_id</code>.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Logs table:</p>
<table>
  <thead>
      <tr>
          <th>log_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
      </tr>
      <tr>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
      </tr>
      <tr>
          <td>7</td>
      </tr>
      <tr>
          <td>8</td>
      </tr>
      <tr>
          <td>10</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>start_id</th>
          <th>end_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>7</td>
          <td>8</td>
      </tr>
      <tr>
          <td>10</td>
          <td>10</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>Range 1–3 is continuous.</li>
<li>4–6 is missing.</li>
<li>Range 7–8 is continuous.</li>
<li>9 is missing.</li>
<li>10 is a single-element range.

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- Solution using subqueries
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">l1</span><span class="p">.</span><span class="n">log_id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">start_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">l2</span><span class="p">.</span><span class="n">log_id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">end_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">log_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Logs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">log_id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Logs</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">l1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">log_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Logs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">log_id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Logs</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">l2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">l1</span><span class="p">.</span><span class="n">log_id</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">l2</span><span class="p">.</span><span class="n">log_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">l1</span><span class="p">.</span><span class="n">log_id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- Solution using variables
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">MIN</span><span class="p">(</span><span class="n">log_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">start_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">MAX</span><span class="p">(</span><span class="n">log_id</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">end_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="p">(</span><span class="o">@</span><span class="n">id</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Logs</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">id</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">init</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">tmp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">log_id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details></li>
</ul>
</li>
</ul>
<h2 id="1294-weather-type-in-each-country">1294. Weather Type in Each Country</h2>
<h4 id="description-62">Description</h4>
<p>Table: Countries</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>country_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>country_name</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>country_id</code> is the primary key.</li>
<li>Each row contains the ID and name of a country.</li>
</ul>
<p>Table: Weather</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>country_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>weather_state</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>day</td>
          <td>date</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(country_id, day)</code> is the primary key.</li>
<li>Each row indicates the weather state in a country for one day.</li>
</ul>
<p>Write an SQL query to find the <strong>type of weather</strong> in each country for <strong>November 2019</strong>.</p>
<ul>
<li><code>weather_type</code> rules:
<ul>
<li>&ldquo;Cold&rdquo; if average <code>weather_state</code> ≤ 15</li>
<li>&ldquo;Hot&rdquo; if average <code>weather_state</code> ≥ 25</li>
<li>&ldquo;Warm&rdquo; otherwise</li>
</ul>
</li>
<li>Return the result table in any order.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Countries table:</p>
<table>
  <thead>
      <tr>
          <th>country_id</th>
          <th>country_name</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2</td>
          <td>USA</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Australia</td>
      </tr>
      <tr>
          <td>7</td>
          <td>Peru</td>
      </tr>
      <tr>
          <td>5</td>
          <td>China</td>
      </tr>
      <tr>
          <td>8</td>
          <td>Morocco</td>
      </tr>
      <tr>
          <td>9</td>
          <td>Spain</td>
      </tr>
  </tbody>
</table>
<p>Weather table:</p>
<table>
  <thead>
      <tr>
          <th>country_id</th>
          <th>weather_state</th>
          <th>day</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2</td>
          <td>15</td>
          <td>2019-11-01</td>
      </tr>
      <tr>
          <td>3</td>
          <td>-2</td>
          <td>2019-11-10</td>
      </tr>
      <tr>
          <td>3</td>
          <td>0</td>
          <td>2019-11-11</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>2019-11-12</td>
      </tr>
      <tr>
          <td>5</td>
          <td>16</td>
          <td>2019-11-07</td>
      </tr>
      <tr>
          <td>5</td>
          <td>18</td>
          <td>2019-11-09</td>
      </tr>
      <tr>
          <td>5</td>
          <td>21</td>
          <td>2019-11-23</td>
      </tr>
      <tr>
          <td>7</td>
          <td>25</td>
          <td>2019-11-28</td>
      </tr>
      <tr>
          <td>8</td>
          <td>25</td>
          <td>2019-11-05</td>
      </tr>
      <tr>
          <td>8</td>
          <td>27</td>
          <td>2019-11-15</td>
      </tr>
      <tr>
          <td>8</td>
          <td>31</td>
          <td>2019-11-25</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>country_name</th>
          <th>weather_type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>USA</td>
          <td>Cold</td>
      </tr>
      <tr>
          <td>Australia</td>
          <td>Cold</td>
      </tr>
      <tr>
          <td>Peru</td>
          <td>Hot</td>
      </tr>
      <tr>
          <td>China</td>
          <td>Warm</td>
      </tr>
      <tr>
          <td>Morocco</td>
          <td>Hot</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>USA average in November = 15 → Cold</li>
<li>Australia average = (-2 + 0 + 3)/3 = 0.33 → Cold</li>
<li>Peru average = 25 → Hot</li>
<li>China average = (16 + 18 + 21)/3 ≈ 18.33 → Warm</li>
<li>Morocco average = (25 + 27 + 31)/3 ≈ 27.67 → Hot</li>
<li>Spain has no data for November → excluded

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">country_name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="k">WHEN</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">weather_state</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;Cold&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="k">WHEN</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">weather_state</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;Hot&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;Warm&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">weather_type</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Weather</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">w</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Countries</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">country_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">.</span><span class="n">country_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">day</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2019-11-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2019-11-30&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">w</span><span class="p">.</span><span class="n">country_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details></li>
</ul>
</li>
</ul>
<h2 id="1303-find-the-team-size">1303. Find the Team Size</h2>
<h4 id="description-63">Description</h4>
<p>Table: Employee</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>employee_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>team_id</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>employee_id</code> is the primary key.</li>
<li>Each row contains the ID of an employee and their respective team.</li>
</ul>
<p>Write an SQL query to find the <strong>team size</strong> of each employee.</p>
<ul>
<li>Return the result table in any order.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Employee table:</p>
<table>
  <thead>
      <tr>
          <th>employee_id</th>
          <th>team_id</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>8</td>
      </tr>
      <tr>
          <td>2</td>
          <td>8</td>
      </tr>
      <tr>
          <td>3</td>
          <td>8</td>
      </tr>
      <tr>
          <td>4</td>
          <td>7</td>
      </tr>
      <tr>
          <td>5</td>
          <td>9</td>
      </tr>
      <tr>
          <td>6</td>
          <td>9</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>employee_id</th>
          <th>team_size</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>3</td>
      </tr>
      <tr>
          <td>2</td>
          <td>3</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
      </tr>
      <tr>
          <td>4</td>
          <td>1</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2</td>
      </tr>
      <tr>
          <td>6</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>Employees 1, 2, 3 are in team 8 → team size 3</li>
<li>Employee 4 is in team 7 → team size 1</li>
<li>Employees 5, 6 are in team 9 → team size 2

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">t</span><span class="p">.</span><span class="n">team_size</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">team_id</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">team_size</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">team_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">team_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">team_id</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details></li>
</ul>
</li>
</ul>
<h2 id="1308-running-total-for-different-genders">1308. Running Total for Different Genders</h2>
<h4 id="description-64">Description</h4>
<p>Table: Scores</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>player_name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>gender</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>day</td>
          <td>date</td>
      </tr>
      <tr>
          <td>score_points</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(gender, day)</code> is the primary key.</li>
<li>Each row indicates a player’s score on a certain day.</li>
<li>Gender is <code>'F'</code> for females team, <code>'M'</code> for males team.</li>
</ul>
<p>Write an SQL query to find the <strong>total score</strong> for each gender at each day.</p>
<ul>
<li>Order the result by <code>gender</code> and <code>day</code>.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Scores table:</p>
<table>
  <thead>
      <tr>
          <th>player_name</th>
          <th>gender</th>
          <th>day</th>
          <th>score_points</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Aron</td>
          <td>F</td>
          <td>2020-01-01</td>
          <td>17</td>
      </tr>
      <tr>
          <td>Alice</td>
          <td>F</td>
          <td>2020-01-07</td>
          <td>23</td>
      </tr>
      <tr>
          <td>Bajrang</td>
          <td>M</td>
          <td>2020-01-07</td>
          <td>7</td>
      </tr>
      <tr>
          <td>Khali</td>
          <td>M</td>
          <td>2019-12-25</td>
          <td>11</td>
      </tr>
      <tr>
          <td>Slaman</td>
          <td>M</td>
          <td>2019-12-30</td>
          <td>13</td>
      </tr>
      <tr>
          <td>Joe</td>
          <td>M</td>
          <td>2019-12-31</td>
          <td>3</td>
      </tr>
      <tr>
          <td>Jose</td>
          <td>M</td>
          <td>2019-12-18</td>
          <td>2</td>
      </tr>
      <tr>
          <td>Priya</td>
          <td>F</td>
          <td>2019-12-31</td>
          <td>23</td>
      </tr>
      <tr>
          <td>Priyanka</td>
          <td>F</td>
          <td>2019-12-30</td>
          <td>17</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>gender</th>
          <th>day</th>
          <th>total</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>F</td>
          <td>2019-12-30</td>
          <td>17</td>
      </tr>
      <tr>
          <td>F</td>
          <td>2019-12-31</td>
          <td>40</td>
      </tr>
      <tr>
          <td>F</td>
          <td>2020-01-01</td>
          <td>57</td>
      </tr>
      <tr>
          <td>F</td>
          <td>2020-01-07</td>
          <td>80</td>
      </tr>
      <tr>
          <td>M</td>
          <td>2019-12-18</td>
          <td>2</td>
      </tr>
      <tr>
          <td>M</td>
          <td>2019-12-25</td>
          <td>13</td>
      </tr>
      <tr>
          <td>M</td>
          <td>2019-12-30</td>
          <td>26</td>
      </tr>
      <tr>
          <td>M</td>
          <td>2019-12-31</td>
          <td>29</td>
      </tr>
      <tr>
          <td>M</td>
          <td>2020-01-07</td>
          <td>36</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>Running total for females: 17 → 40 → 57 → 80</li>
<li>Running total for males: 2 → 13 → 26 → 29 → 36

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="n">gender</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">s1</span><span class="p">.</span><span class="k">day</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">SUM</span><span class="p">(</span><span class="n">s2</span><span class="p">.</span><span class="n">score_points</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="n">gender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s2</span><span class="p">.</span><span class="n">gender</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="k">day</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">s2</span><span class="p">.</span><span class="k">day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="k">day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="k">day</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details></li>
</ul>
</li>
</ul>
<h2 id="1321-restaurant-growth">1321. Restaurant Growth</h2>
<h4 id="description-65">Description</h4>
<p>Table: Customer</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>customer_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>visited_on</td>
          <td>date</td>
      </tr>
      <tr>
          <td>amount</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(customer_id, visited_on)</code> is the primary key.</li>
<li>This table contains customer transactions in a restaurant.</li>
<li><code>visited_on</code> is the date of visit.</li>
<li><code>amount</code> is the total paid by a customer.</li>
</ul>
<p>Write an SQL query to compute <strong>moving average</strong> of customer payments in a 7-day window (current day + 6 previous days).</p>
<ul>
<li>Return <code>visited_on</code>, total <code>amount</code> of that day, and <code>average_amount</code> (rounded to 2 decimals).</li>
<li>Order by <code>visited_on</code>.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Customer table:</p>
<table>
  <thead>
      <tr>
          <th>customer_id</th>
          <th>name</th>
          <th>visited_on</th>
          <th>amount</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Jhon</td>
          <td>2019-01-01</td>
          <td>100</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Daniel</td>
          <td>2019-01-02</td>
          <td>110</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Jade</td>
          <td>2019-01-03</td>
          <td>120</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Khaled</td>
          <td>2019-01-04</td>
          <td>130</td>
      </tr>
      <tr>
          <td>5</td>
          <td>Winston</td>
          <td>2019-01-05</td>
          <td>110</td>
      </tr>
      <tr>
          <td>6</td>
          <td>Elvis</td>
          <td>2019-01-06</td>
          <td>140</td>
      </tr>
      <tr>
          <td>7</td>
          <td>Anna</td>
          <td>2019-01-07</td>
          <td>150</td>
      </tr>
      <tr>
          <td>8</td>
          <td>Maria</td>
          <td>2019-01-08</td>
          <td>80</td>
      </tr>
      <tr>
          <td>9</td>
          <td>Jaze</td>
          <td>2019-01-09</td>
          <td>110</td>
      </tr>
      <tr>
          <td>1</td>
          <td>Jhon</td>
          <td>2019-01-10</td>
          <td>130</td>
      </tr>
      <tr>
          <td>3</td>
          <td>Jade</td>
          <td>2019-01-10</td>
          <td>150</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>visited_on</th>
          <th>amount</th>
          <th>average_amount</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2019-01-07</td>
          <td>860</td>
          <td>122.86</td>
      </tr>
      <tr>
          <td>2019-01-08</td>
          <td>840</td>
          <td>120.00</td>
      </tr>
      <tr>
          <td>2019-01-09</td>
          <td>840</td>
          <td>120.00</td>
      </tr>
      <tr>
          <td>2019-01-10</td>
          <td>1000</td>
          <td>142.86</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ol>
<li>First moving average (2019-01-01 to 2019-01-07): (100 + 110 + 120 + 130 + 110 + 140 + 150)/7 = 122.86</li>
<li>Second moving average (2019-01-02 to 2019-01-08): 120</li>
<li>Third moving average (2019-01-03 to 2019-01-09): 120</li>
<li>Fourth moving average (2019-01-04 to 2019-01-10): 142.86

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL, user defined variables)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">visited_on</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">amount</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">average_amount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">visited_on</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">cnt</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">cnt</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">d7</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">d6</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">d6</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">d5</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">d5</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">d4</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">d4</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">d3</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">d3</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">d2</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">d2</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">d1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">d1</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">@</span><span class="n">total</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">d1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">d2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">d3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">d4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">d5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">d6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">@</span><span class="n">d7</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ROUND</span><span class="p">(</span><span class="o">@</span><span class="n">total</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average_amount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">visited_on</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">amount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Customer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">visited_on</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">c</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">cnt</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">total</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">d1</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">d2</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">d3</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">d4</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">d5</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">d6</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">@</span><span class="n">d7</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details></li>
</ol>
</li>
</ul>
<h2 id="1322-ads-performance">1322. Ads Performance</h2>
<h4 id="description-66">Description</h4>
<p>Table: Ads</p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ad_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>user_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>action</td>
          <td>enum</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(ad_id, user_id)</code> is the primary key.</li>
<li><code>action</code> can be one of: <code>'Clicked'</code>, <code>'Viewed'</code>, <code>'Ignored'</code>.</li>
<li>Each row represents a user&rsquo;s action on an Ad.</li>
</ul>
<p>A company wants to calculate the performance of each Ad using <strong>Click-Through Rate (CTR)</strong>:</p>
<ul>
<li><strong>CTR</strong> formula:
<ul>
<li>If <code>total_clicks + total_views = 0</code>, CTR = 0</li>
<li>Otherwise: <code>CTR = total_clicks / (total_clicks + total_views) * 100</code></li>
</ul>
</li>
</ul>
<p>Write an SQL query to find CTR for each Ad.</p>
<ul>
<li>Round CTR to 2 decimals.</li>
<li>Order by CTR descending, and by <code>ad_id</code> ascending in case of tie.</li>
</ul>
<p><strong>Example:</strong></p>
<p>Ads table:</p>
<table>
  <thead>
      <tr>
          <th>ad_id</th>
          <th>user_id</th>
          <th>action</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>Clicked</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2</td>
          <td>Clicked</td>
      </tr>
      <tr>
          <td>3</td>
          <td>3</td>
          <td>Viewed</td>
      </tr>
      <tr>
          <td>5</td>
          <td>5</td>
          <td>Ignored</td>
      </tr>
      <tr>
          <td>1</td>
          <td>7</td>
          <td>Ignored</td>
      </tr>
      <tr>
          <td>2</td>
          <td>7</td>
          <td>Viewed</td>
      </tr>
      <tr>
          <td>3</td>
          <td>5</td>
          <td>Clicked</td>
      </tr>
      <tr>
          <td>1</td>
          <td>4</td>
          <td>Viewed</td>
      </tr>
      <tr>
          <td>2</td>
          <td>11</td>
          <td>Viewed</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>Clicked</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>ad_id</th>
          <th>ctr</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>66.67</td>
      </tr>
      <tr>
          <td>3</td>
          <td>50.00</td>
      </tr>
      <tr>
          <td>2</td>
          <td>33.33</td>
      </tr>
      <tr>
          <td>5</td>
          <td>0.00</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>ad_id=1: CTR = 2 / (2+1) * 100 = 66.67</li>
<li>ad_id=2: CTR = 1 / (1+2) * 100 = 33.33</li>
<li>ad_id=3: CTR = 1 / (1+1) * 100 = 50.00</li>
<li>ad_id=5: CTR = 0 (no clicks or views)

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ad_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ROUND</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">clicks</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">views</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">clicks</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">views</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ctr</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ad_id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;Clicked&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">clicks</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SUM</span><span class="p">(</span><span class="k">IF</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;Viewed&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">views</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Ads</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ad_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ctr</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">ad_id</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details></li>
</ul>
</li>
</ul>
<h2 id="1327-list-the-products-ordered-in-a-period">1327. List the Products Ordered in a Period</h2>
<h4 id="description-67">Description</h4>
<p><strong>Table: Products</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>product_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>product_name</td>
          <td>varchar</td>
      </tr>
      <tr>
          <td>product_category</td>
          <td>varchar</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>product_id</code> is the primary key.</li>
</ul>
<p><strong>Table: Orders</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>product_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>order_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>unit</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>product_id</code> is a foreign key to Products.</li>
<li><code>unit</code> is the number of products ordered on <code>order_date</code>.</li>
<li>There may be duplicate rows.</li>
</ul>
<p>Write an SQL query to get the names of products with <strong>≥ 100 units</strong> ordered in <strong>February 2020</strong> and their total amount. Return the result in any order.</p>
<p><strong>Example:</strong></p>
<p>Products table:</p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>product_name</th>
          <th>product_category</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>Leetcode Solutions</td>
          <td>Book</td>
      </tr>
      <tr>
          <td>2</td>
          <td>Jewels of Stringology</td>
          <td>Book</td>
      </tr>
      <tr>
          <td>3</td>
          <td>HP</td>
          <td>Laptop</td>
      </tr>
      <tr>
          <td>4</td>
          <td>Lenovo</td>
          <td>Laptop</td>
      </tr>
      <tr>
          <td>5</td>
          <td>Leetcode Kit</td>
          <td>T-shirt</td>
      </tr>
  </tbody>
</table>
<p>Orders table:</p>
<table>
  <thead>
      <tr>
          <th>product_id</th>
          <th>order_date</th>
          <th>unit</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2020-02-05</td>
          <td>60</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2020-02-10</td>
          <td>70</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2020-01-18</td>
          <td>30</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2020-02-11</td>
          <td>80</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2020-02-17</td>
          <td>2</td>
      </tr>
      <tr>
          <td>3</td>
          <td>2020-02-24</td>
          <td>3</td>
      </tr>
      <tr>
          <td>4</td>
          <td>2020-03-01</td>
          <td>20</td>
      </tr>
      <tr>
          <td>4</td>
          <td>2020-03-04</td>
          <td>30</td>
      </tr>
      <tr>
          <td>4</td>
          <td>2020-03-04</td>
          <td>60</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2020-02-25</td>
          <td>50</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2020-02-27</td>
          <td>50</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2020-03-01</td>
          <td>50</td>
      </tr>
  </tbody>
</table>
<p>Result table:</p>
<table>
  <thead>
      <tr>
          <th>product_name</th>
          <th>unit</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Leetcode Solutions</td>
          <td>130</td>
      </tr>
      <tr>
          <td>Leetcode Kit</td>
          <td>100</td>
      </tr>
  </tbody>
</table>
<ul>
<li><strong>Explanation:</strong>
<ul>
<li>Product 1: 60 + 70 = 130</li>
<li>Product 5: 50 + 50 = 100</li>
<li>Products 2, 3, 4 do not reach 100 units in Feb 2020

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">product_name</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">unit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Orders</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">o</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Products</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">order_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="s1">&#39;2020-02-01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="s1">&#39;2020-02-29&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">product_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details></li>
</ul>
</li>
</ul>
<h2 id="1336-number-of-transactions-per-visit">1336. Number of Transactions per Visit</h2>
<h4 id="description-68">Description</h4>
<p><strong>Table: Visits</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>user_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>visit_date</td>
          <td>date</td>
      </tr>
  </tbody>
</table>
<ul>
<li><code>(user_id, visit_date)</code> is the primary key.</li>
<li>Each row indicates that a user visited the bank on that date.</li>
</ul>
<p><strong>Table: Transactions</strong></p>
<table>
  <thead>
      <tr>
          <th>Column Name</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>user_id</td>
          <td>int</td>
      </tr>
      <tr>
          <td>transaction_date</td>
          <td>date</td>
      </tr>
      <tr>
          <td>amount</td>
          <td>int</td>
      </tr>
  </tbody>
</table>
<ul>
<li>There is no primary key; may contain duplicates.</li>
<li>Each row indicates a transaction by a user on <code>transaction_date</code>.</li>
<li>It is guaranteed that a transaction occurs on a day the user visited (<code>Visits</code> table contains the pair <code>(user_id, transaction_date)</code>).</li>
</ul>
<p>Write an SQL query to find the number of users who did <code>0, 1, 2, ...</code> transactions per visit. The result should include all counts from <code>0</code> up to the maximum transactions by any user in a single visit.</p>
<p><strong>Result columns:</strong></p>
<ul>
<li><code>transactions_count</code>: number of transactions in one visit</li>
<li><code>visits_count</code>: number of visits with that many transactions</li>
</ul>
<p>Order by <code>transactions_count</code>.</p>
<h4 id="example">Example</h4>
<p><strong>Visits table:</strong></p>
<table>
  <thead>
      <tr>
          <th>user_id</th>
          <th>visit_date</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2020-01-01</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2020-01-02</td>
      </tr>
      <tr>
          <td>12</td>
          <td>2020-01-01</td>
      </tr>
      <tr>
          <td>19</td>
          <td>2020-01-03</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2020-01-02</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2020-01-03</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2020-01-04</td>
      </tr>
      <tr>
          <td>7</td>
          <td>2020-01-11</td>
      </tr>
      <tr>
          <td>9</td>
          <td>2020-01-25</td>
      </tr>
      <tr>
          <td>8</td>
          <td>2020-01-28</td>
      </tr>
  </tbody>
</table>
<p><strong>Transactions table:</strong></p>
<table>
  <thead>
      <tr>
          <th>user_id</th>
          <th>transaction_date</th>
          <th>amount</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>2020-01-02</td>
          <td>120</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2020-01-03</td>
          <td>22</td>
      </tr>
      <tr>
          <td>7</td>
          <td>2020-01-11</td>
          <td>232</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2020-01-04</td>
          <td>7</td>
      </tr>
      <tr>
          <td>9</td>
          <td>2020-01-25</td>
          <td>33</td>
      </tr>
      <tr>
          <td>9</td>
          <td>2020-01-25</td>
          <td>66</td>
      </tr>
      <tr>
          <td>8</td>
          <td>2020-01-28</td>
          <td>1</td>
      </tr>
      <tr>
          <td>9</td>
          <td>2020-01-25</td>
          <td>99</td>
      </tr>
  </tbody>
</table>
<p><strong>Result table:</strong></p>
<table>
  <thead>
      <tr>
          <th>transactions_count</th>
          <th>visits_count</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0</td>
          <td>4</td>
      </tr>
      <tr>
          <td>1</td>
          <td>5</td>
      </tr>
      <tr>
          <td>2</td>
          <td>0</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<ul>
<li>Explanation:
<ul>
<li><code>0</code> transactions: 4 visits</li>
<li><code>1</code> transaction: 5 visits</li>
<li><code>2</code> transactions: 0 visits</li>
<li><code>3</code> transactions: 1 visit</li>
</ul>
</li>
</ul>
<hr>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution (MySQL)
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">transactions_count</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">visits_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">Visits</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">visit_date</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">transaction_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">Transactions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">transactions_count</span><span class="p">,</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">visits_count</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">visits_count</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">visits_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">tc</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">transactions_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">tc</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">@</span><span class="n">tc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Transactions</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">tc</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">u</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">tc</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">IFNULL</span><span class="p">(</span><span class="k">MAX</span><span class="p">(</span><span class="n">transactions_count</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">transactions_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="n">Transactions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">transaction_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">transactions_count</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">visits_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">transactions_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Transactions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">transaction_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">transactions_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">transactions_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">transactions_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">transactions_count</span><span class="p">;</span></span></span></code></pre></div>
  </div>
</details>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<head>
  <style>
    #R-logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-right: auto;
    }

    #R-logo img {
      width: 48px;
      height: 48px;
      object-fit: contain;
      cursor: pointer;
      transition: transform 0.2s ease-in-out;
    }

    #R-logo img:hover {
      transform: scale(1.05);
    }

    #R-logo .logo-title {
  margin-left: 0.5rem;   
  font-size: 1.2rem;     
  line-height: 1;        
  display: flex;
  align-items: center;   
}
  </style>
</head>



<a id="R-logo" class="R-default" href="/">
  <img src="/images/logo.png" alt="brand logo">
  <span class="logo-title">Relearn</span>
</a>
        </div>
        <search><form action="/search/" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/sql/"><input type="checkbox" id="R-section-6b91b02647756f9b5e29b003bccc4db0" aria-controls="R-subsections-6b91b02647756f9b5e29b003bccc4db0"><label for="R-section-6b91b02647756f9b5e29b003bccc4db0"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu SQL</span></label><a class="padding" href="/sql/">SQL<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-6b91b02647756f9b5e29b003bccc4db0" class="collapsible-menu">
            <li class="" data-nav-id="/sql/select/"><a class="padding" href="/sql/select/">SELECT Query<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/ddl/"><a class="padding" href="/sql/ddl/">DDL<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/dml/"><a class="padding" href="/sql/dml/">DML<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/filter/"><a class="padding" href="/sql/filter/">Filtering Data<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/joins/"><a class="padding" href="/sql/joins/">Joins<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/set-operations/"><a class="padding" href="/sql/set-operations/">Set Operations<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/string-functions/"><a class="padding" href="/sql/string-functions/">String Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/number-functions/"><a class="padding" href="/sql/number-functions/">Number Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/date-time1/"><a class="padding" href="/sql/date-time1/">Date &amp; Time Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/date-time2/"><a class="padding" href="/sql/date-time2/">Date &amp; Time Formats<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/null-functions/"><a class="padding" href="/sql/null-functions/">NULL Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/case-statement/"><a class="padding" href="/sql/case-statement/">CASE Statement<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/aggregate-functions/"><a class="padding" href="/sql/aggregate-functions/">Aggregate Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/window-functions/"><a class="padding" href="/sql/window-functions/">Window Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/window_aggregations/"><a class="padding" href="/sql/window_aggregations/">Window Aggregate Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/window-ranking/"><a class="padding" href="/sql/window-ranking/">Window Ranking Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/window-value-functions/"><a class="padding" href="/sql/window-value-functions/">Window Value Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/subqueries/"><a class="padding" href="/sql/subqueries/">Subquery Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/cte/"><a class="padding" href="/sql/cte/">Common Table Expressions (CTEs)<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/views/"><a class="padding" href="/sql/views/">Views<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/temporary-tables/"><a class="padding" href="/sql/temporary-tables/">Temporary Tables<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/stored-procedures/"><a class="padding" href="/sql/stored-procedures/">Stored Procedures<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/triggers/"><a class="padding" href="/sql/triggers/">Triggers<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/indexes/"><a class="padding" href="/sql/indexes/">Indexes<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/partitions/"><a class="padding" href="/sql/partitions/">Partitioning<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/performance-optimization/"><a class="padding" href="/sql/performance-optimization/">Performance Tips<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/sql/ai-and-sql/"><a class="padding" href="/sql/ai-and-sql/">AI and SQL<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li>
            <li class="" data-nav-id="/azure_data_factory/"><a class="padding" href="/azure_data_factory/">ADF<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/"><input type="checkbox" id="R-section-be307a2f2d32c2a195add2e28563a24e" aria-controls="R-subsections-be307a2f2d32c2a195add2e28563a24e"><label for="R-section-be307a2f2d32c2a195add2e28563a24e"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu ADB</span></label><a class="padding" href="/azure_data_bricks/">ADB<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-be307a2f2d32c2a195add2e28563a24e" class="collapsible-menu">
            <li class="" data-nav-id="/azure_data_bricks/spark/"><a class="padding" href="/azure_data_bricks/spark/">Spark<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/df-creation/"><a class="padding" href="/azure_data_bricks/df-creation/">DF Basics<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/df-operations/"><a class="padding" href="/azure_data_bricks/df-operations/">DF Operations<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/functions/"><a class="padding" href="/azure_data_bricks/functions/">Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/date/"><a class="padding" href="/azure_data_bricks/date/">Date Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/nulls/"><a class="padding" href="/azure_data_bricks/nulls/">Handling Nulls<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/aggregations/"><a class="padding" href="/azure_data_bricks/aggregations/">Aggregate functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/joins/"><a class="padding" href="/azure_data_bricks/joins/">Joins<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/when/"><a class="padding" href="/azure_data_bricks/when/">When|Cast|Union<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/window-functions/"><a class="padding" href="/azure_data_bricks/window-functions/">Window Functions<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/explode/"><a class="padding" href="/azure_data_bricks/explode/">Explode<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/pivot/"><a class="padding" href="/azure_data_bricks/pivot/">Pivot<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/azure_data_bricks/comparisons/"><a class="padding" href="/azure_data_bricks/comparisons/">Comparisons<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li>
            <li class="parent " data-nav-id="/practice/"><input type="checkbox" id="R-section-21344c0a5719731e2ce7649deede330a" aria-controls="R-subsections-21344c0a5719731e2ce7649deede330a" checked><label for="R-section-21344c0a5719731e2ce7649deede330a"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Practice Sets</span></label><a class="padding" href="/practice/">Practice Sets<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-21344c0a5719731e2ce7649deede330a" class="collapsible-menu">
            <li class="active " data-nav-id="/practice/leetcode-sql/"><a class="padding" href="/practice/leetcode-sql/">SQL LeetCode<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/practice/pyspark1/"><a class="padding" href="/practice/pyspark1/">Pyspark 1<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li>
            <li class="" data-nav-id="/interviewprep/"><input type="checkbox" id="R-section-4c46d08ac015ee7f150578d25f17ee2b" aria-controls="R-subsections-4c46d08ac015ee7f150578d25f17ee2b"><label for="R-section-4c46d08ac015ee7f150578d25f17ee2b"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Interview Prep</span></label><a class="padding" href="/interviewprep/">Interview Prep<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-4c46d08ac015ee7f150578d25f17ee2b" class="collapsible-menu">
            <li class="" data-nav-id="/interviewprep/adf1/"><a class="padding" href="/interviewprep/adf1/">ADF 1<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/interviewprep/pipeline1/"><a class="padding" href="/interviewprep/pipeline1/">Data Pipeline<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/interviewprep/sql1/"><a class="padding" href="/interviewprep/sql1/">SQL Theory<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/interviewprep/sql2/"><a class="padding" href="/interviewprep/sql2/">100 SQL Queries<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/interviewprep/sql3/"><a class="padding" href="/interviewprep/sql3/">SQL cheat sheet<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/interviewprep/quick-ref/"><a class="padding" href="/interviewprep/quick-ref/">SQL &amp; PySpark Queries<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
            <li class="R-variantswitcher">
              <div class="padding menu-control">
                <i class="fa-fw fas fa-paint-brush"></i>
                <span>&nbsp;</span>
                <div class="control-style">
                  <label class="a11y-only" for="R-select-variant">Theme</label>
                  <select id="R-select-variant">
                    <option id="R-select-variant-auto" value="auto" selected>Auto</option>
                    <option id="R-select-variant-zen-light" value="zen-light">Zen Light</option>
                    <option id="R-select-variant-zen-dark" value="zen-dark">Zen Dark</option>
                  </select>
                </div>
                <div class="clear"></div>
              </div>
              <script>window.relearn.markVariant();</script>
            </li>
            <li class="R-historyclearer">
              <div class="padding menu-control">
                <i class="fa-fw fas fa-history"></i>
                <span>&nbsp;</span>
                <div class="control-style">
                  <button>Clear History</button>
                </div>
                <div class="clear"></div>
              </div>
            </li>
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script src="/js/js-yaml/js-yaml.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-color.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-drag.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-ease.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-selection.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-timer.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-transition.min.js?1761501432" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1761501432" defer></script>
    <script src="/js/mermaid/mermaid.min.js?1761501432" defer></script>
    <script>
      window.relearn.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/clipboard/clipboard.min.js?1761501432" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1761501432" defer></script>
    <script src="/js/theme.js?1761501432" defer></script>
  </body>
</html>
